í
ID:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\Conexion.cs
	namespace 	
SistemaDiagnostico
 
. 
AccesoDatos (
{		 
class

 	
Conexion


 
{ 
private 
string 
BD 
; 
private 
string 
Server 
; 
private 
string 
User 
; 
private 
string 
Clave 
; 
private 
bool 
Autenticacion "
;" #
private 
static 
Conexion 
cnx  #
=$ %
null& *
;* +
private 
Conexion 
( 
) 
{ 	
this 
. 
BD 
= 
$str #
;# $
this 
. 
Server 
= 
$str 7
;7 8
this 
. 
User 
= 
$str 
; 
this 
. 
Clave 
= 
$str 
; 
this 
. 
Autenticacion 
=  
true! %
;% &
} 	
public 
SqlConnection 
EstablecerConexion /
(/ 0
)0 1
{ 	
SqlConnection 
cadenaconex %
=& '
new( +
SqlConnection, 9
(9 :
): ;
;; <
try   
{!! 
cadenaconex"" 
."" 
ConnectionString"" ,
=""- .
$str""/ 8
+""9 :
this""; ?
.""? @
Server""@ F
+""G H
$str""I L
+## 
$str## !
+##" #
this##$ (
.##( )
BD##) +
+##, -
$str##. 1
;##1 2
if%% 
(%% 
this%% 
.%% 
Autenticacion%% &
)%%& '
{&& 
cadenaconex'' 
.''  
ConnectionString''  0
=''1 2
cadenaconex''3 >
.''> ?
ConnectionString''? O
+''P Q
$str''R n
;''n o
}(( 
else)) 
{** 
cadenaconex++ 
.++  
ConnectionString++  0
=++1 2
cadenaconex++3 >
.++> ?
ConnectionString++? O
+++P Q
$str++R \
+++] ^
this,, 
.,, 
User,, !
+,," #
$str,,$ '
+,,( )
$str,,* 5
+,,6 7
this,,8 <
.,,< =
Clave,,= B
;,,B C
}-- 
}.. 
catch// 
(// 
	Exception// 
ex// 
)//  
{00 
cadenaconex11 
=11 
null11 "
;11" #
throw22 
ex22 
;22 
}33 
return44 
cadenaconex44 
;44 
}55 	
public77 
static77 
Conexion77 
getInstance77 *
(77* +
)77+ ,
{88 	
if99 
(99 
cnx99 
==99 
null99 
)99 
{:: 
cnx;; 
=;; 
new;; 
Conexion;; "
(;;" #
);;# $
;;;$ %
}<< 
return== 
cnx== 
;== 
}>> 	
}?? 
}@@ À)
XD:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\DetalleDiagnosticoDatos.cs
	namespace 	
SistemaDiagnostico
 
. 
AccesoDatos (
{ 
public 

class #
DetalleDiagnosticoDatos (
{ 
public 
string 
Insertar 
( %
DetalleDiagnosticoEntidad 8
objDiagnostico9 G
)G H
{ 	
string 
Rpta 
= 
$str 
; 
SqlConnection 
sqlConnection '
=( )
new* -
SqlConnection. ;
(; <
)< =
;= >
try 
{ 
sqlConnection 
= 
Conexion  (
.( )
getInstance) 4
(4 5
)5 6
.6 7
EstablecerConexion7 I
(I J
)J K
;K L

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 O
,O P
sqlConnectionQ ^
)^ _
;_ `
comando 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
comando 
. 

Parameters "
." #
Add# &
(& '
$str' 9
,9 :
	SqlDbType; D
.D E
IntE H
)H I
.I J
ValueJ O
=P Q
objDiagnosticoR `
.` a
DiagnosticoIda n
;n o
comando   
.   

Parameters   "
.  " #
Add  # &
(  & '
$str  ' 2
,  2 3
	SqlDbType  4 =
.  = >
VarChar  > E
)  E F
.  F G
Value  G L
=  M N
objDiagnostico  O ]
.  ] ^
Sintoma  ^ e
;  e f
sqlConnection"" 
."" 
Open"" "
(""" #
)""# $
;""$ %
Rpta$$ 
=$$ 
comando$$ 
.$$ 
ExecuteNonQuery$$ .
($$. /
)$$/ 0
==$$1 3
$num$$4 5
?$$6 7
$str$$8 B
:$$C D
$str$$E f
;$$f g
}%% 
catch&& 
(&& 
	Exception&& 
ex&& 
)&&  
{'' 
Rpta(( 
=(( 
ex(( 
.(( 
Message(( !
;((! "
})) 
finally** 
{++ 
if,, 
(,, 
sqlConnection,, !
.,,! "
State,," '
==,,( *
ConnectionState,,+ :
.,,: ;
Open,,; ?
),,? @
sqlConnection,,A N
.,,N O
Close,,O T
(,,T U
),,U V
;,,V W
}-- 
return.. 
Rpta.. 
;.. 
}// 	
public22 
string22 
Eliminar22 
(22 
int22 "
Id22# %
)22% &
{33 	
string44 
Rpta44 
=44 
$str44 
;44 
SqlConnection66 
sqlConnection66 '
=66( )
new66* -
SqlConnection66. ;
(66; <
)66< =
;66= >
try88 
{99 
sqlConnection;; 
=;; 
Conexion;;  (
.;;( )
getInstance;;) 4
(;;4 5
);;5 6
.;;6 7
EstablecerConexion;;7 I
(;;I J
);;J K
;;;K L

SqlCommand== 
comando== "
===# $
new==% (

SqlCommand==) 3
(==3 4
$str==4 O
,==O P
sqlConnection==Q ^
)==^ _
;==_ `
comando?? 
.?? 
CommandType?? #
=??$ %
CommandType??& 1
.??1 2
StoredProcedure??2 A
;??A B
comandoAA 
.AA 

ParametersAA "
.AA" #
AddAA# &
(AA& '
$strAA' 9
,AA9 :
	SqlDbTypeAA; D
.AAD E
IntAAE H
)AAH I
.AAI J
ValueAAJ O
=AAP Q
IdAAR T
;AAT U
sqlConnectionCC 
.CC 
OpenCC "
(CC" #
)CC# $
;CC$ %
RptaEE 
=EE 
comandoEE 
.EE 
ExecuteNonQueryEE .
(EE. /
)EE/ 0
==EE1 3
$numEE4 5
?EE6 7
$strEE8 B
:EEC D
$strEEE f
;EEf g
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
RptaII 
=II 
exII 
.II 
MessageII !
;II! "
}JJ 
finallyKK 
{LL 
ifMM 
(MM 
sqlConnectionMM !
.MM! "
StateMM" '
==MM( *
ConnectionStateMM+ :
.MM: ;
OpenMM; ?
)MM? @
sqlConnectionMMA N
.MMN O
CloseMMO T
(MMT U
)MMU V
;MMV W
}NN 
returnOO 
RptaOO 
;OO 
}PP 	
}RR 
}SS ˇè
QD:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\DiagnosticoDatos.cs
	namespace 	
SistemaDiagnostico
 
. 
AccesoDatos (
{ 
public 

class 
DiagnosticoDatos !
{ 
public 
	DataTable 
GrafEnfermedades )
() *
)* +
{ 	
SqlDataReader 
	Resultado #
;# $
	DataTable 
Tabla 
= 
new !
	DataTable" +
(+ ,
), -
;- .
SqlConnection 
sqlConnection '
=( )
new* -
SqlConnection. ;
(; <
)< =
;= >
try 
{ 
sqlConnection 
= 
Conexion  (
.( )
getInstance) 4
(4 5
)5 6
.6 7
EstablecerConexion7 I
(I J
)J K
;K L

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 A
,A B
sqlConnectionC P
)P Q
;Q R
comando 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
sqlConnection 
. 
Open "
(" #
)# $
;$ %
	Resultado   
=   
comando   #
.  # $
ExecuteReader  $ 1
(  1 2
)  2 3
;  3 4
Tabla!! 
.!! 
Load!! 
(!! 
	Resultado!! $
)!!$ %
;!!% &
return"" 
Tabla"" 
;"" 
}$$ 
catch%% 
(%% 
	Exception%% 
ex%% 
)%%  
{&& 
throw'' 
ex'' 
;'' 
}(( 
finally)) 
{** 
if++ 
(++ 
sqlConnection++ !
.++! "
State++" '
==++( *
ConnectionState+++ :
.++: ;
Open++; ?
)++? @
sqlConnection++A N
.++N O
Close++O T
(++T U
)++U V
;++V W
},, 
}.. 	
public22 
	DataTable22 
GrafEnfermedades222 *
(22* +
)22+ ,
{33 	
SqlDataReader55 
	Resultado55 #
;55# $
	DataTable66 
Tabla66 
=66 
new66 !
	DataTable66" +
(66+ ,
)66, -
;66- .
SqlConnection77 
sqlConnection77 '
=77( )
new77* -
SqlConnection77. ;
(77; <
)77< =
;77= >
try99 
{:: 
sqlConnection<< 
=<< 
Conexion<<  (
.<<( )
getInstance<<) 4
(<<4 5
)<<5 6
.<<6 7
EstablecerConexion<<7 I
(<<I J
)<<J K
;<<K L

SqlCommand>> 
comando>> "
=>># $
new>>% (

SqlCommand>>) 3
(>>3 4
$str>>4 B
,>>B C
sqlConnection>>D Q
)>>Q R
;>>R S
comando?? 
.?? 
CommandType?? #
=??$ %
CommandType??& 1
.??1 2
StoredProcedure??2 A
;??A B
sqlConnection@@ 
.@@ 
Open@@ "
(@@" #
)@@# $
;@@$ %
	ResultadoAA 
=AA 
comandoAA #
.AA# $
ExecuteReaderAA$ 1
(AA1 2
)AA2 3
;AA3 4
TablaBB 
.BB 
LoadBB 
(BB 
	ResultadoBB $
)BB$ %
;BB% &
returnCC 
TablaCC 
;CC 
}EE 
catchFF 
(FF 
	ExceptionFF 
exFF 
)FF  
{GG 
throwHH 
exHH 
;HH 
}II 
finallyJJ 
{KK 
ifLL 
(LL 
sqlConnectionLL !
.LL! "
StateLL" '
==LL( *
ConnectionStateLL+ :
.LL: ;
OpenLL; ?
)LL? @
sqlConnectionLLA N
.LLN O
CloseLLO T
(LLT U
)LLU V
;LLV W
}MM 
}OO 	
publicRR 
	DataTableRR 
GrafEnfermedades3RR *
(RR* +
)RR+ ,
{SS 	
SqlDataReaderUU 
	ResultadoUU #
;UU# $
	DataTableVV 
TablaVV 
=VV 
newVV !
	DataTableVV" +
(VV+ ,
)VV, -
;VV- .
SqlConnectionWW 
sqlConnectionWW '
=WW( )
newWW* -
SqlConnectionWW. ;
(WW; <
)WW< =
;WW= >
tryYY 
{ZZ 
sqlConnection\\ 
=\\ 
Conexion\\  (
.\\( )
getInstance\\) 4
(\\4 5
)\\5 6
.\\6 7
EstablecerConexion\\7 I
(\\I J
)\\J K
;\\K L

SqlCommand^^ 
comando^^ "
=^^# $
new^^% (

SqlCommand^^) 3
(^^3 4
$str^^4 B
,^^B C
sqlConnection^^D Q
)^^Q R
;^^R S
comando__ 
.__ 
CommandType__ #
=__$ %
CommandType__& 1
.__1 2
StoredProcedure__2 A
;__A B
sqlConnection`` 
.`` 
Open`` "
(``" #
)``# $
;``$ %
	Resultadoaa 
=aa 
comandoaa #
.aa# $
ExecuteReaderaa$ 1
(aa1 2
)aa2 3
;aa3 4
Tablabb 
.bb 
Loadbb 
(bb 
	Resultadobb $
)bb$ %
;bb% &
returncc 
Tablacc 
;cc 
}ee 
catchff 
(ff 
	Exceptionff 
exff 
)ff  
{gg 
throwhh 
exhh 
;hh 
}ii 
finallyjj 
{kk 
ifll 
(ll 
sqlConnectionll !
.ll! "
Statell" '
==ll( *
ConnectionStatell+ :
.ll: ;
Openll; ?
)ll? @
sqlConnectionllA N
.llN O
ClosellO T
(llT U
)llU V
;llV W
}mm 
}oo 	
publicss 
	DataTabless 
GrafEnfermedades4ss *
(ss* +
)ss+ ,
{tt 	
SqlDataReadervv 
	Resultadovv #
;vv# $
	DataTableww 
Tablaww 
=ww 
newww !
	DataTableww" +
(ww+ ,
)ww, -
;ww- .
SqlConnectionxx 
sqlConnectionxx '
=xx( )
newxx* -
SqlConnectionxx. ;
(xx; <
)xx< =
;xx= >
tryzz 
{{{ 
sqlConnection}} 
=}} 
Conexion}}  (
.}}( )
getInstance}}) 4
(}}4 5
)}}5 6
.}}6 7
EstablecerConexion}}7 I
(}}I J
)}}J K
;}}K L

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 B
,B C
sqlConnectionD Q
)Q R
;R S
comando
ÄÄ 
.
ÄÄ 
CommandType
ÄÄ #
=
ÄÄ$ %
CommandType
ÄÄ& 1
.
ÄÄ1 2
StoredProcedure
ÄÄ2 A
;
ÄÄA B
sqlConnection
ÅÅ 
.
ÅÅ 
Open
ÅÅ "
(
ÅÅ" #
)
ÅÅ# $
;
ÅÅ$ %
	Resultado
ÇÇ 
=
ÇÇ 
comando
ÇÇ #
.
ÇÇ# $
ExecuteReader
ÇÇ$ 1
(
ÇÇ1 2
)
ÇÇ2 3
;
ÇÇ3 4
Tabla
ÉÉ 
.
ÉÉ 
Load
ÉÉ 
(
ÉÉ 
	Resultado
ÉÉ $
)
ÉÉ$ %
;
ÉÉ% &
return
ÑÑ 
Tabla
ÑÑ 
;
ÑÑ 
}
ÜÜ 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
àà 
throw
ââ 
ex
ââ 
;
ââ 
}
ää 
finally
ãã 
{
åå 
if
çç 
(
çç 
sqlConnection
çç !
.
çç! "
State
çç" '
==
çç( *
ConnectionState
çç+ :
.
çç: ;
Open
çç; ?
)
çç? @
sqlConnection
ççA N
.
ççN O
Close
ççO T
(
ççT U
)
ççU V
;
ççV W
}
éé 
}
êê 	
public
ìì 
	DataTable
ìì 
GrafEnfermedades5
ìì *
(
ìì* +
)
ìì+ ,
{
îî 	
SqlDataReader
ññ 
	Resultado
ññ #
;
ññ# $
	DataTable
óó 
Tabla
óó 
=
óó 
new
óó !
	DataTable
óó" +
(
óó+ ,
)
óó, -
;
óó- .
SqlConnection
òò 
sqlConnection
òò '
=
òò( )
new
òò* -
SqlConnection
òò. ;
(
òò; <
)
òò< =
;
òò= >
try
öö 
{
õõ 
sqlConnection
ùù 
=
ùù 
Conexion
ùù  (
.
ùù( )
getInstance
ùù) 4
(
ùù4 5
)
ùù5 6
.
ùù6 7 
EstablecerConexion
ùù7 I
(
ùùI J
)
ùùJ K
;
ùùK L

SqlCommand
üü 
comando
üü "
=
üü# $
new
üü% (

SqlCommand
üü) 3
(
üü3 4
$str
üü4 B
,
üüB C
sqlConnection
üüD Q
)
üüQ R
;
üüR S
comando
†† 
.
†† 
CommandType
†† #
=
††$ %
CommandType
††& 1
.
††1 2
StoredProcedure
††2 A
;
††A B
sqlConnection
°° 
.
°° 
Open
°° "
(
°°" #
)
°°# $
;
°°$ %
	Resultado
¢¢ 
=
¢¢ 
comando
¢¢ #
.
¢¢# $
ExecuteReader
¢¢$ 1
(
¢¢1 2
)
¢¢2 3
;
¢¢3 4
Tabla
££ 
.
££ 
Load
££ 
(
££ 
	Resultado
££ $
)
££$ %
;
££% &
return
§§ 
Tabla
§§ 
;
§§ 
}
¶¶ 
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß  
{
®® 
throw
©© 
ex
©© 
;
©© 
}
™™ 
finally
´´ 
{
¨¨ 
if
≠≠ 
(
≠≠ 
sqlConnection
≠≠ !
.
≠≠! "
State
≠≠" '
==
≠≠( *
ConnectionState
≠≠+ :
.
≠≠: ;
Open
≠≠; ?
)
≠≠? @
sqlConnection
≠≠A N
.
≠≠N O
Close
≠≠O T
(
≠≠T U
)
≠≠U V
;
≠≠V W
}
ÆÆ 
}
∞∞ 	
public
¥¥ 
	DataTable
¥¥ 
GrafEnfermedades6
¥¥ *
(
¥¥* +
)
¥¥+ ,
{
µµ 	
SqlDataReader
∑∑ 
	Resultado
∑∑ #
;
∑∑# $
	DataTable
∏∏ 
Tabla
∏∏ 
=
∏∏ 
new
∏∏ !
	DataTable
∏∏" +
(
∏∏+ ,
)
∏∏, -
;
∏∏- .
SqlConnection
ππ 
sqlConnection
ππ '
=
ππ( )
new
ππ* -
SqlConnection
ππ. ;
(
ππ; <
)
ππ< =
;
ππ= >
try
ªª 
{
ºº 
sqlConnection
ææ 
=
ææ 
Conexion
ææ  (
.
ææ( )
getInstance
ææ) 4
(
ææ4 5
)
ææ5 6
.
ææ6 7 
EstablecerConexion
ææ7 I
(
ææI J
)
ææJ K
;
ææK L

SqlCommand
¿¿ 
comando
¿¿ "
=
¿¿# $
new
¿¿% (

SqlCommand
¿¿) 3
(
¿¿3 4
$str
¿¿4 B
,
¿¿B C
sqlConnection
¿¿D Q
)
¿¿Q R
;
¿¿R S
comando
¡¡ 
.
¡¡ 
CommandType
¡¡ #
=
¡¡$ %
CommandType
¡¡& 1
.
¡¡1 2
StoredProcedure
¡¡2 A
;
¡¡A B
sqlConnection
¬¬ 
.
¬¬ 
Open
¬¬ "
(
¬¬" #
)
¬¬# $
;
¬¬$ %
	Resultado
√√ 
=
√√ 
comando
√√ #
.
√√# $
ExecuteReader
√√$ 1
(
√√1 2
)
√√2 3
;
√√3 4
Tabla
ƒƒ 
.
ƒƒ 
Load
ƒƒ 
(
ƒƒ 
	Resultado
ƒƒ $
)
ƒƒ$ %
;
ƒƒ% &
return
≈≈ 
Tabla
≈≈ 
;
≈≈ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
…… 
throw
   
ex
   
;
   
}
ÀÀ 
finally
ÃÃ 
{
ÕÕ 
if
ŒŒ 
(
ŒŒ 
sqlConnection
ŒŒ !
.
ŒŒ! "
State
ŒŒ" '
==
ŒŒ( *
ConnectionState
ŒŒ+ :
.
ŒŒ: ;
Open
ŒŒ; ?
)
ŒŒ? @
sqlConnection
ŒŒA N
.
ŒŒN O
Close
ŒŒO T
(
ŒŒT U
)
ŒŒU V
;
ŒŒV W
}
œœ 
}
—— 	
public
‘‘ 
	DataTable
‘‘ 
GrafEnfermedades7
‘‘ *
(
‘‘* +
)
‘‘+ ,
{
’’ 	
SqlDataReader
◊◊ 
	Resultado
◊◊ #
;
◊◊# $
	DataTable
ÿÿ 
Tabla
ÿÿ 
=
ÿÿ 
new
ÿÿ !
	DataTable
ÿÿ" +
(
ÿÿ+ ,
)
ÿÿ, -
;
ÿÿ- .
SqlConnection
ŸŸ 
sqlConnection
ŸŸ '
=
ŸŸ( )
new
ŸŸ* -
SqlConnection
ŸŸ. ;
(
ŸŸ; <
)
ŸŸ< =
;
ŸŸ= >
try
€€ 
{
‹‹ 
sqlConnection
ﬁﬁ 
=
ﬁﬁ 
Conexion
ﬁﬁ  (
.
ﬁﬁ( )
getInstance
ﬁﬁ) 4
(
ﬁﬁ4 5
)
ﬁﬁ5 6
.
ﬁﬁ6 7 
EstablecerConexion
ﬁﬁ7 I
(
ﬁﬁI J
)
ﬁﬁJ K
;
ﬁﬁK L

SqlCommand
‡‡ 
comando
‡‡ "
=
‡‡# $
new
‡‡% (

SqlCommand
‡‡) 3
(
‡‡3 4
$str
‡‡4 B
,
‡‡B C
sqlConnection
‡‡D Q
)
‡‡Q R
;
‡‡R S
comando
·· 
.
·· 
CommandType
·· #
=
··$ %
CommandType
··& 1
.
··1 2
StoredProcedure
··2 A
;
··A B
sqlConnection
‚‚ 
.
‚‚ 
Open
‚‚ "
(
‚‚" #
)
‚‚# $
;
‚‚$ %
	Resultado
„„ 
=
„„ 
comando
„„ #
.
„„# $
ExecuteReader
„„$ 1
(
„„1 2
)
„„2 3
;
„„3 4
Tabla
‰‰ 
.
‰‰ 
Load
‰‰ 
(
‰‰ 
	Resultado
‰‰ $
)
‰‰$ %
;
‰‰% &
return
ÂÂ 
Tabla
ÂÂ 
;
ÂÂ 
}
ÁÁ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÈÈ 
throw
ÍÍ 
ex
ÍÍ 
;
ÍÍ 
}
ÎÎ 
finally
ÏÏ 
{
ÌÌ 
if
ÓÓ 
(
ÓÓ 
sqlConnection
ÓÓ !
.
ÓÓ! "
State
ÓÓ" '
==
ÓÓ( *
ConnectionState
ÓÓ+ :
.
ÓÓ: ;
Open
ÓÓ; ?
)
ÓÓ? @
sqlConnection
ÓÓA N
.
ÓÓN O
Close
ÓÓO T
(
ÓÓT U
)
ÓÓU V
;
ÓÓV W
}
ÔÔ 
}
ÒÒ 	
public
ÙÙ 
	DataTable
ÙÙ 
Listar
ÙÙ 
(
ÙÙ  
)
ÙÙ  !
{
ıı 	
SqlDataReader
ˆˆ 
	Resultado
ˆˆ #
;
ˆˆ# $
	DataTable
˜˜ 
Tabla
˜˜ 
=
˜˜ 
new
˜˜ !
	DataTable
˜˜" +
(
˜˜+ ,
)
˜˜, -
;
˜˜- .
SqlConnection
¯¯ 
sqlConnection
¯¯ '
=
¯¯( )
new
¯¯* -
SqlConnection
¯¯. ;
(
¯¯; <
)
¯¯< =
;
¯¯= >
try
˙˙ 
{
˚˚ 
sqlConnection
˝˝ 
=
˝˝ 
Conexion
˝˝  (
.
˝˝( )
getInstance
˝˝) 4
(
˝˝4 5
)
˝˝5 6
.
˝˝6 7 
EstablecerConexion
˝˝7 I
(
˝˝I J
)
˝˝J K
;
˝˝K L

SqlCommand
ˇˇ 
comando
ˇˇ "
=
ˇˇ# $
new
ˇˇ% (

SqlCommand
ˇˇ) 3
(
ˇˇ3 4
$str
ˇˇ4 I
,
ˇˇI J
sqlConnection
ˇˇK X
)
ˇˇX Y
;
ˇˇY Z
comando
ÄÄ 
.
ÄÄ 
CommandType
ÄÄ #
=
ÄÄ$ %
CommandType
ÄÄ& 1
.
ÄÄ1 2
StoredProcedure
ÄÄ2 A
;
ÄÄA B
sqlConnection
ÅÅ 
.
ÅÅ 
Open
ÅÅ "
(
ÅÅ" #
)
ÅÅ# $
;
ÅÅ$ %
	Resultado
ÇÇ 
=
ÇÇ 
comando
ÇÇ #
.
ÇÇ# $
ExecuteReader
ÇÇ$ 1
(
ÇÇ1 2
)
ÇÇ2 3
;
ÇÇ3 4
Tabla
ÉÉ 
.
ÉÉ 
Load
ÉÉ 
(
ÉÉ 
	Resultado
ÉÉ $
)
ÉÉ$ %
;
ÉÉ% &
return
ÑÑ 
Tabla
ÑÑ 
;
ÑÑ 
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
áá 
throw
àà 
ex
àà 
;
àà 
}
ââ 
finally
ää 
{
ãã 
if
åå 
(
åå 
sqlConnection
åå !
.
åå! "
State
åå" '
==
åå( *
ConnectionState
åå+ :
.
åå: ;
Open
åå; ?
)
åå? @
sqlConnection
ååA N
.
ååN O
Close
ååO T
(
ååT U
)
ååU V
;
ååV W
}
çç 
}
èè 	
public
íí 
	DataTable
íí 
Buscar
íí 
(
íí  
string
íí  &
Busqueda
íí' /
)
íí/ 0
{
ìì 	
SqlDataReader
îî 
	Resultado
îî #
;
îî# $
	DataTable
ïï 
Tabla
ïï 
=
ïï 
new
ïï !
	DataTable
ïï" +
(
ïï+ ,
)
ïï, -
;
ïï- .
SqlConnection
ññ 
sqlConnection
ññ '
=
ññ( )
new
ññ* -
SqlConnection
ññ. ;
(
ññ; <
)
ññ< =
;
ññ= >
try
òò 
{
ôô 
sqlConnection
õõ 
=
õõ 
Conexion
õõ  (
.
õõ( )
getInstance
õõ) 4
(
õõ4 5
)
õõ5 6
.
õõ6 7 
EstablecerConexion
õõ7 I
(
õõI J
)
õõJ K
;
õõK L

SqlCommand
ùù 
comando
ùù "
=
ùù# $
new
ùù% (

SqlCommand
ùù) 3
(
ùù3 4
$str
ùù4 P
,
ùùP Q
sqlConnection
ùùR _
)
ùù_ `
;
ùù` a
comando
üü 
.
üü 
CommandType
üü #
=
üü$ %
CommandType
üü& 1
.
üü1 2
StoredProcedure
üü2 A
;
üüA B
comando
°° 
.
°° 

Parameters
°° "
.
°°" #
Add
°°# &
(
°°& '
$str
°°' 3
,
°°3 4
	SqlDbType
°°5 >
.
°°> ?
VarChar
°°? F
)
°°F G
.
°°G H
Value
°°H M
=
°°N O
Busqueda
°°P X
;
°°X Y
sqlConnection
¢¢ 
.
¢¢ 
Open
¢¢ "
(
¢¢" #
)
¢¢# $
;
¢¢$ %
	Resultado
££ 
=
££ 
comando
££ #
.
££# $
ExecuteReader
££$ 1
(
££1 2
)
££2 3
;
££3 4
Tabla
§§ 
.
§§ 
Load
§§ 
(
§§ 
	Resultado
§§ $
)
§§$ %
;
§§% &
return
•• 
Tabla
•• 
;
•• 
}
¶¶ 
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß  
{
®® 
throw
©© 
ex
©© 
;
©© 
}
™™ 
finally
´´ 
{
¨¨ 
if
≠≠ 
(
≠≠ 
sqlConnection
≠≠ !
.
≠≠! "
State
≠≠" '
==
≠≠( *
ConnectionState
≠≠+ :
.
≠≠: ;
Open
≠≠; ?
)
≠≠? @
sqlConnection
≠≠A N
.
≠≠N O
Close
≠≠O T
(
≠≠T U
)
≠≠U V
;
≠≠V W
}
ÆÆ 
}
∞∞ 	
public
≥≥ 
	DataTable
≥≥ 
BuscarPD
≥≥ !
(
≥≥! "
string
≥≥" (
Busqueda
≥≥) 1
)
≥≥1 2
{
¥¥ 	
SqlDataReader
µµ 
	Resultado
µµ #
;
µµ# $
	DataTable
∂∂ 
Tabla
∂∂ 
=
∂∂ 
new
∂∂ !
	DataTable
∂∂" +
(
∂∂+ ,
)
∂∂, -
;
∂∂- .
SqlConnection
∑∑ 
sqlConnection
∑∑ '
=
∑∑( )
new
∑∑* -
SqlConnection
∑∑. ;
(
∑∑; <
)
∑∑< =
;
∑∑= >
try
ππ 
{
∫∫ 
sqlConnection
ΩΩ 
=
ΩΩ 
Conexion
ΩΩ  (
.
ΩΩ( )
getInstance
ΩΩ) 4
(
ΩΩ4 5
)
ΩΩ5 6
.
ΩΩ6 7 
EstablecerConexion
ΩΩ7 I
(
ΩΩI J
)
ΩΩJ K
;
ΩΩK L

SqlCommand
øø 
comando
øø "
=
øø# $
new
øø% (

SqlCommand
øø) 3
(
øø3 4
$str
øø4 P
,
øøP Q
sqlConnection
øøR _
)
øø_ `
;
øø` a
comando
¡¡ 
.
¡¡ 
CommandType
¡¡ #
=
¡¡$ %
CommandType
¡¡& 1
.
¡¡1 2
StoredProcedure
¡¡2 A
;
¡¡A B
comando
√√ 
.
√√ 

Parameters
√√ "
.
√√" #
Add
√√# &
(
√√& '
$str
√√' 3
,
√√3 4
	SqlDbType
√√5 >
.
√√> ?
VarChar
√√? F
)
√√F G
.
√√G H
Value
√√H M
=
√√N O
Busqueda
√√P X
;
√√X Y
sqlConnection
ƒƒ 
.
ƒƒ 
Open
ƒƒ "
(
ƒƒ" #
)
ƒƒ# $
;
ƒƒ$ %
	Resultado
≈≈ 
=
≈≈ 
comando
≈≈ #
.
≈≈# $
ExecuteReader
≈≈$ 1
(
≈≈1 2
)
≈≈2 3
;
≈≈3 4
Tabla
∆∆ 
.
∆∆ 
Load
∆∆ 
(
∆∆ 
	Resultado
∆∆ $
)
∆∆$ %
;
∆∆% &
return
»» 
Tabla
»» 
;
»» 
}
   
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÃÃ 
throw
ÕÕ 
ex
ÕÕ 
;
ÕÕ 
}
ŒŒ 
finally
œœ 
{
–– 
if
—— 
(
—— 
sqlConnection
—— !
.
——! "
State
——" '
==
——( *
ConnectionState
——+ :
.
——: ;
Open
——; ?
)
——? @
sqlConnection
——A N
.
——N O
Close
——O T
(
——T U
)
——U V
;
——V W
}
““ 
}
”” 	
public
÷÷ 
string
÷÷ 
Insertar
÷÷ 
(
÷÷  
DiagnosticoEntidad
÷÷ 1
objDiagnostico
÷÷2 @
)
÷÷@ A
{
◊◊ 	
string
ÿÿ 
Rpta
ÿÿ 
=
ÿÿ 
$str
ÿÿ 
;
ÿÿ 
SqlConnection
⁄⁄ 
sqlConnection
⁄⁄ '
=
⁄⁄( )
new
⁄⁄* -
SqlConnection
⁄⁄. ;
(
⁄⁄; <
)
⁄⁄< =
;
⁄⁄= >
try
‹‹ 
{
›› 
sqlConnection
ﬂﬂ 
=
ﬂﬂ 
Conexion
ﬂﬂ  (
.
ﬂﬂ( )
getInstance
ﬂﬂ) 4
(
ﬂﬂ4 5
)
ﬂﬂ5 6
.
ﬂﬂ6 7 
EstablecerConexion
ﬂﬂ7 I
(
ﬂﬂI J
)
ﬂﬂJ K
;
ﬂﬂK L

SqlCommand
·· 
comando
·· "
=
··# $
new
··% (

SqlCommand
··) 3
(
··3 4
$str
··4 G
,
··G H
sqlConnection
··I V
)
··V W
;
··W X
comando
„„ 
.
„„ 
CommandType
„„ #
=
„„$ %
CommandType
„„& 1
.
„„1 2
StoredProcedure
„„2 A
;
„„A B
comando
ÂÂ 
.
ÂÂ 

Parameters
ÂÂ "
.
ÂÂ" #
Add
ÂÂ# &
(
ÂÂ& '
$str
ÂÂ' 8
,
ÂÂ8 9
	SqlDbType
ÂÂ: C
.
ÂÂC D
Int
ÂÂD G
)
ÂÂG H
.
ÂÂH I
Value
ÂÂI N
=
ÂÂO P
objDiagnostico
ÂÂQ _
.
ÂÂ_ `
DiagnosticoId
ÂÂ` m
;
ÂÂm n
comando
ÊÊ 
.
ÊÊ 

Parameters
ÊÊ "
.
ÊÊ" #
Add
ÊÊ# &
(
ÊÊ& '
$str
ÊÊ' 6
,
ÊÊ6 7
	SqlDbType
ÊÊ8 A
.
ÊÊA B
VarChar
ÊÊB I
)
ÊÊI J
.
ÊÊJ K
Value
ÊÊK P
=
ÊÊQ R
objDiagnostico
ÊÊS a
.
ÊÊa b
dniEmpleado
ÊÊb m
;
ÊÊm n
comando
ÁÁ 
.
ÁÁ 

Parameters
ÁÁ "
.
ÁÁ" #
Add
ÁÁ# &
(
ÁÁ& '
$str
ÁÁ' .
,
ÁÁ. /
	SqlDbType
ÁÁ0 9
.
ÁÁ9 :
VarChar
ÁÁ: A
)
ÁÁA B
.
ÁÁB C
Value
ÁÁC H
=
ÁÁI J
objDiagnostico
ÁÁK Y
.
ÁÁY Z
Dni
ÁÁZ ]
;
ÁÁ] ^
comando
ËË 
.
ËË 

Parameters
ËË "
.
ËË" #
Add
ËË# &
(
ËË& '
$str
ËË' 0
,
ËË0 1
	SqlDbType
ËË2 ;
.
ËË; <
VarChar
ËË< C
)
ËËC D
.
ËËD E
Value
ËËE J
=
ËËK L
objDiagnostico
ËËM [
.
ËË[ \
Fecha
ËË\ a
;
ËËa b
comando
ÈÈ 
.
ÈÈ 

Parameters
ÈÈ "
.
ÈÈ" #
Add
ÈÈ# &
(
ÈÈ& '
$str
ÈÈ' 5
,
ÈÈ5 6
	SqlDbType
ÈÈ7 @
.
ÈÈ@ A
VarChar
ÈÈA H
)
ÈÈH I
.
ÈÈI J
Value
ÈÈJ O
=
ÈÈP Q
objDiagnostico
ÈÈR `
.
ÈÈ` a

Enfermedad
ÈÈa k
;
ÈÈk l
sqlConnection
ÎÎ 
.
ÎÎ 
Open
ÎÎ "
(
ÎÎ" #
)
ÎÎ# $
;
ÎÎ$ %
Rpta
ÌÌ 
=
ÌÌ 
comando
ÌÌ 
.
ÌÌ 
ExecuteNonQuery
ÌÌ .
(
ÌÌ. /
)
ÌÌ/ 0
==
ÌÌ1 3
$num
ÌÌ4 5
?
ÌÌ6 7
$str
ÌÌ8 B
:
ÌÌC D
$str
ÌÌE f
;
ÌÌf g
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
 
Rpta
ÒÒ 
=
ÒÒ 
ex
ÒÒ 
.
ÒÒ 
Message
ÒÒ !
;
ÒÒ! "
}
ÚÚ 
finally
ÛÛ 
{
ÙÙ 
if
ıı 
(
ıı 
sqlConnection
ıı !
.
ıı! "
State
ıı" '
==
ıı( *
ConnectionState
ıı+ :
.
ıı: ;
Open
ıı; ?
)
ıı? @
sqlConnection
ııA N
.
ııN O
Close
ııO T
(
ııT U
)
ııU V
;
ııV W
}
ˆˆ 
return
˜˜ 
Rpta
˜˜ 
;
˜˜ 
}
¯¯ 	
public
˚˚ 
string
˚˚ 

Actualizar
˚˚  
(
˚˚  !
EmpleadoEntidad
˚˚! 0
objEmpleado
˚˚1 <
)
˚˚< =
{
¸¸ 	
string
˝˝ 
Rpta
˝˝ 
=
˝˝ 
$str
˝˝ 
;
˝˝ 
SqlConnection
ˇˇ 
sqlConnection
ˇˇ '
=
ˇˇ( )
new
ˇˇ* -
SqlConnection
ˇˇ. ;
(
ˇˇ; <
)
ˇˇ< =
;
ˇˇ= >
try
ÅÅ 
{
ÇÇ 
sqlConnection
ÑÑ 
=
ÑÑ 
Conexion
ÑÑ  (
.
ÑÑ( )
getInstance
ÑÑ) 4
(
ÑÑ4 5
)
ÑÑ5 6
.
ÑÑ6 7 
EstablecerConexion
ÑÑ7 I
(
ÑÑI J
)
ÑÑJ K
;
ÑÑK L

SqlCommand
ÜÜ 
comando
ÜÜ "
=
ÜÜ# $
new
ÜÜ% (

SqlCommand
ÜÜ) 3
(
ÜÜ3 4
$str
ÜÜ4 D
,
ÜÜD E
sqlConnection
ÜÜF S
)
ÜÜS T
;
ÜÜT U
comando
àà 
.
àà 
CommandType
àà #
=
àà$ %
CommandType
àà& 1
.
àà1 2
StoredProcedure
àà2 A
;
ààA B
comando
ää 
.
ää 

Parameters
ää "
.
ää" #
Add
ää# &
(
ää& '
$str
ää' .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
Int
ää: =
)
ää= >
.
ää> ?
Value
ää? D
=
ääE F
objEmpleado
ääG R
.
ääR S
Dni
ääS V
;
ääV W
comando
ãã 
.
ãã 

Parameters
ãã "
.
ãã" #
Add
ãã# &
(
ãã& '
$str
ãã' 1
,
ãã1 2
	SqlDbType
ãã3 <
.
ãã< =
VarChar
ãã= D
)
ããD E
.
ããE F
Value
ããF K
=
ããL M
objEmpleado
ããN Y
.
ããY Z
Nombre
ããZ `
;
ãã` a
comando
åå 
.
åå 

Parameters
åå "
.
åå" #
Add
åå# &
(
åå& '
$str
åå' 3
,
åå3 4
	SqlDbType
åå5 >
.
åå> ?
VarChar
åå? F
)
ååF G
.
ååG H
Value
ååH M
=
ååN O
objEmpleado
ååP [
.
åå[ \
Apellido
åå\ d
;
ååd e
comando
çç 
.
çç 

Parameters
çç "
.
çç" #
Add
çç# &
(
çç& '
$str
çç' 0
,
çç0 1
	SqlDbType
çç2 ;
.
çç; <
VarChar
çç< C
)
ççC D
.
ççD E
Value
ççE J
=
ççK L
objEmpleado
ççM X
.
ççX Y
Cargo
ççY ^
;
çç^ _
comando
éé 
.
éé 

Parameters
éé "
.
éé" #
Add
éé# &
(
éé& '
$str
éé' 4
,
éé4 5
	SqlDbType
éé6 ?
.
éé? @
VarChar
éé@ G
)
ééG H
.
ééH I
Value
ééI N
=
ééO P
objEmpleado
ééQ \
.
éé\ ]
	Direccion
éé] f
;
ééf g
comando
èè 
.
èè 

Parameters
èè "
.
èè" #
Add
èè# &
(
èè& '
$str
èè' 2
,
èè2 3
	SqlDbType
èè4 =
.
èè= >
VarChar
èè> E
)
èèE F
.
èèF G
Value
èèG L
=
èèM N
objEmpleado
èèO Z
.
èèZ [
Celular
èè[ b
;
èèb c
comando
êê 
.
êê 

Parameters
êê "
.
êê" #
Add
êê# &
(
êê& '
$str
êê' 1
,
êê1 2
	SqlDbType
êê3 <
.
êê< =
VarChar
êê= D
)
êêD E
.
êêE F
Value
êêF K
=
êêL M
objEmpleado
êêN Y
.
êêY Z
Estado
êêZ `
;
êê` a
sqlConnection
íí 
.
íí 
Open
íí "
(
íí" #
)
íí# $
;
íí$ %
Rpta
îî 
=
îî 
comando
îî 
.
îî 
ExecuteNonQuery
îî .
(
îî. /
)
îî/ 0
==
îî1 3
$num
îî4 5
?
îî6 7
$str
îî8 B
:
îîC D
$str
îîE h
;
îîh i
}
ïï 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
óó 
Rpta
òò 
=
òò 
ex
òò 
.
òò 
Message
òò !
;
òò! "
}
ôô 
finally
öö 
{
õõ 
if
úú 
(
úú 
sqlConnection
úú !
.
úú! "
State
úú" '
==
úú( *
ConnectionState
úú+ :
.
úú: ;
Open
úú; ?
)
úú? @
sqlConnection
úúA N
.
úúN O
Close
úúO T
(
úúT U
)
úúU V
;
úúV W
}
ùù 
return
ûû 
Rpta
ûû 
;
ûû 
}
üü 	
public
¢¢ 
string
¢¢ 
Eliminar
¢¢ 
(
¢¢ 
int
¢¢ "
Id
¢¢# %
)
¢¢% &
{
££ 	
string
§§ 
Rpta
§§ 
=
§§ 
$str
§§ 
;
§§ 
SqlConnection
¶¶ 
sqlConnection
¶¶ '
=
¶¶( )
new
¶¶* -
SqlConnection
¶¶. ;
(
¶¶; <
)
¶¶< =
;
¶¶= >
try
®® 
{
©© 
sqlConnection
´´ 
=
´´ 
Conexion
´´  (
.
´´( )
getInstance
´´) 4
(
´´4 5
)
´´5 6
.
´´6 7 
EstablecerConexion
´´7 I
(
´´I J
)
´´J K
;
´´K L

SqlCommand
≠≠ 
comando
≠≠ "
=
≠≠# $
new
≠≠% (

SqlCommand
≠≠) 3
(
≠≠3 4
$str
≠≠4 G
,
≠≠G H
sqlConnection
≠≠I V
)
≠≠V W
;
≠≠W X
comando
ØØ 
.
ØØ 
CommandType
ØØ #
=
ØØ$ %
CommandType
ØØ& 1
.
ØØ1 2
StoredProcedure
ØØ2 A
;
ØØA B
comando
±± 
.
±± 

Parameters
±± "
.
±±" #
Add
±±# &
(
±±& '
$str
±±' 9
,
±±9 :
	SqlDbType
±±; D
.
±±D E
Int
±±E H
)
±±H I
.
±±I J
Value
±±J O
=
±±P Q
Id
±±R T
;
±±T U
sqlConnection
≥≥ 
.
≥≥ 
Open
≥≥ "
(
≥≥" #
)
≥≥# $
;
≥≥$ %
Rpta
µµ 
=
µµ 
comando
µµ 
.
µµ 
ExecuteNonQuery
µµ .
(
µµ. /
)
µµ/ 0
==
µµ1 3
$num
µµ4 5
?
µµ6 7
$str
µµ8 B
:
µµC D
$str
µµE f
;
µµf g
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑  
{
∏∏ 
Rpta
ππ 
=
ππ 
ex
ππ 
.
ππ 
Message
ππ !
;
ππ! "
}
∫∫ 
finally
ªª 
{
ºº 
if
ΩΩ 
(
ΩΩ 
sqlConnection
ΩΩ !
.
ΩΩ! "
State
ΩΩ" '
==
ΩΩ( *
ConnectionState
ΩΩ+ :
.
ΩΩ: ;
Open
ΩΩ; ?
)
ΩΩ? @
sqlConnection
ΩΩA N
.
ΩΩN O
Close
ΩΩO T
(
ΩΩT U
)
ΩΩU V
;
ΩΩV W
}
ææ 
return
øø 
Rpta
øø 
;
øø 
}
¿¿ 	
}
¡¡ 
}¬¬ º¬
ND:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\EmpleadoDatos.cs
	namespace

 	
SistemaDiagnostico


 
.

 
AccesoDatos

 (
{ 
public 

class 
EmpleadoDatos 
{ 
public 
	DataTable 
Listar 
(  
)  !
{ 	
SqlDataReader 
	Resultado #
;# $
	DataTable 
Tabla 
= 
new !
	DataTable" +
(+ ,
), -
;- .
SqlConnection 
sqlConnection '
=( )
new* -
SqlConnection. ;
(; <
)< =
;= >
try 
{ 
sqlConnection 
= 
Conexion  (
.( )
getInstance) 4
(4 5
)5 6
.6 7
EstablecerConexion7 I
(I J
)J K
;K L

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 D
,D E
sqlConnectionF S
)S T
;T U
comando 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
sqlConnection 
. 
Open "
(" #
)# $
;$ %
	Resultado 
= 
comando #
.# $
ExecuteReader$ 1
(1 2
)2 3
;3 4
Tabla 
. 
Load 
( 
	Resultado $
)$ %
;% &
return 
Tabla 
; 
}   
catch!! 
(!! 
	Exception!! 
ex!! 
)!!  
{"" 
throw## 
ex## 
;## 
}$$ 
finally%% 
{&& 
if'' 
('' 
sqlConnection'' !
.''! "
State''" '
==''( *
ConnectionState''+ :
.'': ;
Open''; ?
)''? @
sqlConnection''A N
.''N O
Close''O T
(''T U
)''U V
;''V W
}(( 
}** 	
public-- 
	DataTable-- 
Buscar-- 
(--  
string--  &
Busqueda--' /
)--/ 0
{.. 	
SqlDataReader// 
	Resultado// #
;//# $
	DataTable00 
Tabla00 
=00 
new00 !
	DataTable00" +
(00+ ,
)00, -
;00- .
SqlConnection11 
sqlConnection11 '
=11( )
new11* -
SqlConnection11. ;
(11; <
)11< =
;11= >
try33 
{44 
sqlConnection66 
=66 
Conexion66  (
.66( )
getInstance66) 4
(664 5
)665 6
.666 7
EstablecerConexion667 I
(66I J
)66J K
;66K L

SqlCommand88 
comando88 "
=88# $
new88% (

SqlCommand88) 3
(883 4
$str884 M
,88M N
sqlConnection88O \
)88\ ]
;88] ^
comando:: 
.:: 
CommandType:: #
=::$ %
CommandType::& 1
.::1 2
StoredProcedure::2 A
;::A B
comando<< 
.<< 

Parameters<< "
.<<" #
Add<<# &
(<<& '
$str<<' 3
,<<3 4
	SqlDbType<<5 >
.<<> ?
VarChar<<? F
)<<F G
.<<G H
Value<<H M
=<<N O
Busqueda<<P X
;<<X Y
sqlConnection== 
.== 
Open== "
(==" #
)==# $
;==$ %
	Resultado>> 
=>> 
comando>> #
.>># $
ExecuteReader>>$ 1
(>>1 2
)>>2 3
;>>3 4
Tabla?? 
.?? 
Load?? 
(?? 
	Resultado?? $
)??$ %
;??% &
return@@ 
Tabla@@ 
;@@ 
}AA 
catchBB 
(BB 
	ExceptionBB 
exBB 
)BB  
{CC 
throwDD 
exDD 
;DD 
}EE 
finallyFF 
{GG 
ifHH 
(HH 
sqlConnectionHH !
.HH! "
StateHH" '
==HH( *
ConnectionStateHH+ :
.HH: ;
OpenHH; ?
)HH? @
sqlConnectionHHA N
.HHN O
CloseHHO T
(HHT U
)HHU V
;HHV W
}II 
}KK 	
publicNN 
stringNN 
ExisteNN 
(NN 
stringNN #
ValorNN$ )
)NN) *
{OO 	
stringPP 
RptaPP 
=PP 
$strPP 
;PP 
SqlConnectionRR 
sqlConnectionRR '
=RR( )
newRR* -
SqlConnectionRR. ;
(RR; <
)RR< =
;RR= >
tryTT 
{UU 
sqlConnectionWW 
=WW 
ConexionWW  (
.WW( )
getInstanceWW) 4
(WW4 5
)WW5 6
.WW6 7
EstablecerConexionWW7 I
(WWI J
)WWJ K
;WWK L

SqlCommandYY 
comandoYY "
=YY# $
newYY% (

SqlCommandYY) 3
(YY3 4
$strYY4 L
,YYL M
sqlConnectionYYN [
)YY[ \
;YY\ ]
comando[[ 
.[[ 
CommandType[[ #
=[[$ %
CommandType[[& 1
.[[1 2
StoredProcedure[[2 A
;[[A B
comando]] 
.]] 

Parameters]] "
.]]" #
Add]]# &
(]]& '
$str]]' 0
,]]0 1
	SqlDbType]]2 ;
.]]; <
VarChar]]< C
)]]C D
.]]D E
Value]]E J
=]]K L
Valor]]M R
;]]R S
SqlParameter^^ 
PExiste^^ $
=^^% &
new^^' *
SqlParameter^^+ 7
(^^7 8
)^^8 9
;^^9 :
PExiste__ 
.__ 
ParameterName__ %
=__& '
$str__( 2
;__2 3
PExiste`` 
.`` 
	SqlDbType`` !
=``" #
	SqlDbType``$ -
.``- .
Int``. 1
;``1 2
PExisteaa 
.aa 
	Directionaa !
=aa" #
ParameterDirectionaa$ 6
.aa6 7
Outputaa7 =
;aa= >
sqlConnectionbb 
.bb 
Openbb "
(bb" #
)bb# $
;bb$ %
Rptadd 
=dd 
Convertdd 
.dd 
ToStringdd '
(dd' (
PExistedd( /
.dd/ 0
Valuedd0 5
)dd5 6
;dd6 7
}gg 
catchhh 
(hh 
	Exceptionhh 
exhh 
)hh  
{ii 
Rptajj 
=jj 
exjj 
.jj 
Messagejj !
;jj! "
}kk 
finallyll 
{mm 
ifnn 
(nn 
sqlConnectionnn !
.nn! "
Statenn" '
==nn( *
ConnectionStatenn+ :
.nn: ;
Opennn; ?
)nn? @
sqlConnectionnnA N
.nnN O
ClosennO T
(nnT U
)nnU V
;nnV W
}oo 
returnpp 
Rptapp 
;pp 
}qq 	
publictt 
stringtt 
Insertartt 
(tt 
EmpleadoEntidadtt .
objEmpleadott/ :
)tt: ;
{uu 	
stringvv 
Rptavv 
=vv 
$strvv 
;vv 
SqlConnectionxx 
sqlConnectionxx '
=xx( )
newxx* -
SqlConnectionxx. ;
(xx; <
)xx< =
;xx= >
tryzz 
{{{ 
sqlConnection}} 
=}} 
Conexion}}  (
.}}( )
getInstance}}) 4
(}}4 5
)}}5 6
.}}6 7
EstablecerConexion}}7 I
(}}I J
)}}J K
;}}K L

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 D
,D E
sqlConnectionF S
)S T
;T U
comando
ÅÅ 
.
ÅÅ 
CommandType
ÅÅ #
=
ÅÅ$ %
CommandType
ÅÅ& 1
.
ÅÅ1 2
StoredProcedure
ÅÅ2 A
;
ÅÅA B
comando
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ "
.
ÉÉ" #
Add
ÉÉ# &
(
ÉÉ& '
$str
ÉÉ' .
,
ÉÉ. /
	SqlDbType
ÉÉ0 9
.
ÉÉ9 :
VarChar
ÉÉ: A
)
ÉÉA B
.
ÉÉB C
Value
ÉÉC H
=
ÉÉI J
objEmpleado
ÉÉK V
.
ÉÉV W
Dni
ÉÉW Z
;
ÉÉZ [
comando
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ "
.
ÑÑ" #
Add
ÑÑ# &
(
ÑÑ& '
$str
ÑÑ' 1
,
ÑÑ1 2
	SqlDbType
ÑÑ3 <
.
ÑÑ< =
VarChar
ÑÑ= D
)
ÑÑD E
.
ÑÑE F
Value
ÑÑF K
=
ÑÑL M
objEmpleado
ÑÑN Y
.
ÑÑY Z
Nombre
ÑÑZ `
;
ÑÑ` a
comando
ÖÖ 
.
ÖÖ 

Parameters
ÖÖ "
.
ÖÖ" #
Add
ÖÖ# &
(
ÖÖ& '
$str
ÖÖ' 3
,
ÖÖ3 4
	SqlDbType
ÖÖ5 >
.
ÖÖ> ?
VarChar
ÖÖ? F
)
ÖÖF G
.
ÖÖG H
Value
ÖÖH M
=
ÖÖN O
objEmpleado
ÖÖP [
.
ÖÖ[ \
Apellido
ÖÖ\ d
;
ÖÖd e
comando
ÜÜ 
.
ÜÜ 

Parameters
ÜÜ "
.
ÜÜ" #
Add
ÜÜ# &
(
ÜÜ& '
$str
ÜÜ' 0
,
ÜÜ0 1
	SqlDbType
ÜÜ2 ;
.
ÜÜ; <
VarChar
ÜÜ< C
)
ÜÜC D
.
ÜÜD E
Value
ÜÜE J
=
ÜÜK L
objEmpleado
ÜÜM X
.
ÜÜX Y
Cargo
ÜÜY ^
;
ÜÜ^ _
comando
áá 
.
áá 

Parameters
áá "
.
áá" #
Add
áá# &
(
áá& '
$str
áá' 4
,
áá4 5
	SqlDbType
áá6 ?
.
áá? @
VarChar
áá@ G
)
ááG H
.
ááH I
Value
ááI N
=
ááO P
objEmpleado
ááQ \
.
áá\ ]
	Direccion
áá] f
;
ááf g
comando
àà 
.
àà 

Parameters
àà "
.
àà" #
Add
àà# &
(
àà& '
$str
àà' 2
,
àà2 3
	SqlDbType
àà4 =
.
àà= >
VarChar
àà> E
)
ààE F
.
ààF G
Value
ààG L
=
ààM N
objEmpleado
ààO Z
.
ààZ [
Celular
àà[ b
;
ààb c
comando
ââ 
.
ââ 

Parameters
ââ "
.
ââ" #
Add
ââ# &
(
ââ& '
$str
ââ' 1
,
ââ1 2
	SqlDbType
ââ3 <
.
ââ< =
VarChar
ââ= D
)
ââD E
.
ââE F
Value
ââF K
=
ââL M
objEmpleado
ââN Y
.
ââY Z
Estado
ââZ `
;
ââ` a
sqlConnection
ãã 
.
ãã 
Open
ãã "
(
ãã" #
)
ãã# $
;
ãã$ %
Rpta
çç 
=
çç 
comando
çç 
.
çç 
ExecuteNonQuery
çç .
(
çç. /
)
çç/ 0
==
çç1 3
$num
çç4 5
?
çç6 7
$str
çç8 B
:
ççC D
$str
ççE f
;
ççf g
}
éé 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
êê 
Rpta
ëë 
=
ëë 
ex
ëë 
.
ëë 
Message
ëë !
;
ëë! "
}
íí 
finally
ìì 
{
îî 
if
ïï 
(
ïï 
sqlConnection
ïï !
.
ïï! "
State
ïï" '
==
ïï( *
ConnectionState
ïï+ :
.
ïï: ;
Open
ïï; ?
)
ïï? @
sqlConnection
ïïA N
.
ïïN O
Close
ïïO T
(
ïïT U
)
ïïU V
;
ïïV W
}
ññ 
return
óó 
Rpta
óó 
;
óó 
}
òò 	
public
õõ 
string
õõ 

Actualizar
õõ  
(
õõ  !
EmpleadoEntidad
õõ! 0
objEmpleado
õõ1 <
)
õõ< =
{
úú 	
string
ùù 
Rpta
ùù 
=
ùù 
$str
ùù 
;
ùù 
SqlConnection
üü 
sqlConnection
üü '
=
üü( )
new
üü* -
SqlConnection
üü. ;
(
üü; <
)
üü< =
;
üü= >
try
°° 
{
¢¢ 
sqlConnection
§§ 
=
§§ 
Conexion
§§  (
.
§§( )
getInstance
§§) 4
(
§§4 5
)
§§5 6
.
§§6 7 
EstablecerConexion
§§7 I
(
§§I J
)
§§J K
;
§§K L

SqlCommand
¶¶ 
comando
¶¶ "
=
¶¶# $
new
¶¶% (

SqlCommand
¶¶) 3
(
¶¶3 4
$str
¶¶4 D
,
¶¶D E
sqlConnection
¶¶F S
)
¶¶S T
;
¶¶T U
comando
®® 
.
®® 
CommandType
®® #
=
®®$ %
CommandType
®®& 1
.
®®1 2
StoredProcedure
®®2 A
;
®®A B
comando
™™ 
.
™™ 

Parameters
™™ "
.
™™" #
Add
™™# &
(
™™& '
$str
™™' .
,
™™. /
	SqlDbType
™™0 9
.
™™9 :
VarChar
™™: A
)
™™A B
.
™™B C
Value
™™C H
=
™™I J
objEmpleado
™™K V
.
™™V W
Dni
™™W Z
;
™™Z [
comando
´´ 
.
´´ 

Parameters
´´ "
.
´´" #
Add
´´# &
(
´´& '
$str
´´' 1
,
´´1 2
	SqlDbType
´´3 <
.
´´< =
VarChar
´´= D
)
´´D E
.
´´E F
Value
´´F K
=
´´L M
objEmpleado
´´N Y
.
´´Y Z
Nombre
´´Z `
;
´´` a
comando
¨¨ 
.
¨¨ 

Parameters
¨¨ "
.
¨¨" #
Add
¨¨# &
(
¨¨& '
$str
¨¨' 3
,
¨¨3 4
	SqlDbType
¨¨5 >
.
¨¨> ?
VarChar
¨¨? F
)
¨¨F G
.
¨¨G H
Value
¨¨H M
=
¨¨N O
objEmpleado
¨¨P [
.
¨¨[ \
Apellido
¨¨\ d
;
¨¨d e
comando
≠≠ 
.
≠≠ 

Parameters
≠≠ "
.
≠≠" #
Add
≠≠# &
(
≠≠& '
$str
≠≠' 0
,
≠≠0 1
	SqlDbType
≠≠2 ;
.
≠≠; <
VarChar
≠≠< C
)
≠≠C D
.
≠≠D E
Value
≠≠E J
=
≠≠K L
objEmpleado
≠≠M X
.
≠≠X Y
Cargo
≠≠Y ^
;
≠≠^ _
comando
ÆÆ 
.
ÆÆ 

Parameters
ÆÆ "
.
ÆÆ" #
Add
ÆÆ# &
(
ÆÆ& '
$str
ÆÆ' 4
,
ÆÆ4 5
	SqlDbType
ÆÆ6 ?
.
ÆÆ? @
VarChar
ÆÆ@ G
)
ÆÆG H
.
ÆÆH I
Value
ÆÆI N
=
ÆÆO P
objEmpleado
ÆÆQ \
.
ÆÆ\ ]
	Direccion
ÆÆ] f
;
ÆÆf g
comando
ØØ 
.
ØØ 

Parameters
ØØ "
.
ØØ" #
Add
ØØ# &
(
ØØ& '
$str
ØØ' 2
,
ØØ2 3
	SqlDbType
ØØ4 =
.
ØØ= >
VarChar
ØØ> E
)
ØØE F
.
ØØF G
Value
ØØG L
=
ØØM N
objEmpleado
ØØO Z
.
ØØZ [
Celular
ØØ[ b
;
ØØb c
comando
∞∞ 
.
∞∞ 

Parameters
∞∞ "
.
∞∞" #
Add
∞∞# &
(
∞∞& '
$str
∞∞' 1
,
∞∞1 2
	SqlDbType
∞∞3 <
.
∞∞< =
VarChar
∞∞= D
)
∞∞D E
.
∞∞E F
Value
∞∞F K
=
∞∞L M
objEmpleado
∞∞N Y
.
∞∞Y Z
Estado
∞∞Z `
;
∞∞` a
sqlConnection
≤≤ 
.
≤≤ 
Open
≤≤ "
(
≤≤" #
)
≤≤# $
;
≤≤$ %
Rpta
¥¥ 
=
¥¥ 
comando
¥¥ 
.
¥¥ 
ExecuteNonQuery
¥¥ .
(
¥¥. /
)
¥¥/ 0
==
¥¥1 3
$num
¥¥4 5
?
¥¥6 7
$str
¥¥8 B
:
¥¥C D
$str
¥¥E h
;
¥¥h i
}
µµ 
catch
∂∂ 
(
∂∂ 
	Exception
∂∂ 
ex
∂∂ 
)
∂∂  
{
∑∑ 
Rpta
∏∏ 
=
∏∏ 
ex
∏∏ 
.
∏∏ 
Message
∏∏ !
;
∏∏! "
}
ππ 
finally
∫∫ 
{
ªª 
if
ºº 
(
ºº 
sqlConnection
ºº !
.
ºº! "
State
ºº" '
==
ºº( *
ConnectionState
ºº+ :
.
ºº: ;
Open
ºº; ?
)
ºº? @
sqlConnection
ººA N
.
ººN O
Close
ººO T
(
ººT U
)
ººU V
;
ººV W
}
ΩΩ 
return
ææ 
Rpta
ææ 
;
ææ 
}
øø 	
public
¬¬ 
string
¬¬ 
Eliminar
¬¬ 
(
¬¬ 
string
¬¬ %
Dni
¬¬& )
)
¬¬) *
{
√√ 	
string
ƒƒ 
Rpta
ƒƒ 
=
ƒƒ 
$str
ƒƒ 
;
ƒƒ 
SqlConnection
∆∆ 
sqlConnection
∆∆ '
=
∆∆( )
new
∆∆* -
SqlConnection
∆∆. ;
(
∆∆; <
)
∆∆< =
;
∆∆= >
try
»» 
{
…… 
sqlConnection
ÀÀ 
=
ÀÀ 
Conexion
ÀÀ  (
.
ÀÀ( )
getInstance
ÀÀ) 4
(
ÀÀ4 5
)
ÀÀ5 6
.
ÀÀ6 7 
EstablecerConexion
ÀÀ7 I
(
ÀÀI J
)
ÀÀJ K
;
ÀÀK L

SqlCommand
ÕÕ 
comando
ÕÕ "
=
ÕÕ# $
new
ÕÕ% (

SqlCommand
ÕÕ) 3
(
ÕÕ3 4
$str
ÕÕ4 D
,
ÕÕD E
sqlConnection
ÕÕF S
)
ÕÕS T
;
ÕÕT U
comando
œœ 
.
œœ 
CommandType
œœ #
=
œœ$ %
CommandType
œœ& 1
.
œœ1 2
StoredProcedure
œœ2 A
;
œœA B
comando
—— 
.
—— 

Parameters
—— "
.
——" #
Add
——# &
(
——& '
$str
——' .
,
——. /
	SqlDbType
——0 9
.
——9 :
Char
——: >
)
——> ?
.
——? @
Value
——@ E
=
——F G
Dni
——H K
;
——K L
sqlConnection
”” 
.
”” 
Open
”” "
(
””" #
)
””# $
;
””$ %
Rpta
’’ 
=
’’ 
comando
’’ 
.
’’ 
ExecuteNonQuery
’’ .
(
’’. /
)
’’/ 0
==
’’1 3
$num
’’4 5
?
’’6 7
$str
’’8 B
:
’’C D
$str
’’E f
;
’’f g
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ 
ex
◊◊ 
)
◊◊  
{
ÿÿ 
Rpta
ŸŸ 
=
ŸŸ 
ex
ŸŸ 
.
ŸŸ 
Message
ŸŸ !
;
ŸŸ! "
}
⁄⁄ 
finally
€€ 
{
‹‹ 
if
›› 
(
›› 
sqlConnection
›› !
.
››! "
State
››" '
==
››( *
ConnectionState
››+ :
.
››: ;
Open
››; ?
)
››? @
sqlConnection
››A N
.
››N O
Close
››O T
(
››T U
)
››U V
;
››V W
}
ﬁﬁ 
return
ﬂﬂ 
Rpta
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 	
public
„„ 
string
„„ 
Activar
„„ 
(
„„ 
string
„„ $
Dni
„„% (
)
„„( )
{
‰‰ 	
string
ÂÂ 
Rpta
ÂÂ 
=
ÂÂ 
$str
ÂÂ 
;
ÂÂ 
SqlConnection
ÁÁ 
sqlConnection
ÁÁ '
=
ÁÁ( )
new
ÁÁ* -
SqlConnection
ÁÁ. ;
(
ÁÁ; <
)
ÁÁ< =
;
ÁÁ= >
try
ÈÈ 
{
ÍÍ 
sqlConnection
ÏÏ 
=
ÏÏ 
Conexion
ÏÏ  (
.
ÏÏ( )
getInstance
ÏÏ) 4
(
ÏÏ4 5
)
ÏÏ5 6
.
ÏÏ6 7 
EstablecerConexion
ÏÏ7 I
(
ÏÏI J
)
ÏÏJ K
;
ÏÏK L

SqlCommand
ÓÓ 
comando
ÓÓ "
=
ÓÓ# $
new
ÓÓ% (

SqlCommand
ÓÓ) 3
(
ÓÓ3 4
$str
ÓÓ4 J
,
ÓÓJ K
sqlConnection
ÓÓL Y
)
ÓÓY Z
;
ÓÓZ [
comando
 
.
 
CommandType
 #
=
$ %
CommandType
& 1
.
1 2
StoredProcedure
2 A
;
A B
comando
ÚÚ 
.
ÚÚ 

Parameters
ÚÚ "
.
ÚÚ" #
Add
ÚÚ# &
(
ÚÚ& '
$str
ÚÚ' .
,
ÚÚ. /
	SqlDbType
ÚÚ0 9
.
ÚÚ9 :
VarChar
ÚÚ: A
)
ÚÚA B
.
ÚÚB C
Value
ÚÚC H
=
ÚÚI J
Dni
ÚÚK N
;
ÚÚN O
sqlConnection
ÙÙ 
.
ÙÙ 
Open
ÙÙ "
(
ÙÙ" #
)
ÙÙ# $
;
ÙÙ$ %
Rpta
ˆˆ 
=
ˆˆ 
comando
ˆˆ 
.
ˆˆ 
ExecuteNonQuery
ˆˆ .
(
ˆˆ. /
)
ˆˆ/ 0
==
ˆˆ1 3
$num
ˆˆ4 5
?
ˆˆ6 7
$str
ˆˆ8 B
:
ˆˆC D
$str
ˆˆE e
;
ˆˆe f
}
˜˜ 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
˘˘ 
Rpta
˙˙ 
=
˙˙ 
ex
˙˙ 
.
˙˙ 
Message
˙˙ !
;
˙˙! "
}
˚˚ 
finally
¸¸ 
{
˝˝ 
if
˛˛ 
(
˛˛ 
sqlConnection
˛˛ !
.
˛˛! "
State
˛˛" '
==
˛˛( *
ConnectionState
˛˛+ :
.
˛˛: ;
Open
˛˛; ?
)
˛˛? @
sqlConnection
˛˛A N
.
˛˛N O
Close
˛˛O T
(
˛˛T U
)
˛˛U V
;
˛˛V W
}
ˇˇ 
return
ÄÄ 
Rpta
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
public
ÑÑ 
string
ÑÑ 

Desactivar
ÑÑ  
(
ÑÑ  !
string
ÑÑ! '
Dni
ÑÑ( +
)
ÑÑ+ ,
{
ÖÖ 	
string
ÜÜ 
Rpta
ÜÜ 
=
ÜÜ 
$str
ÜÜ 
;
ÜÜ 
SqlConnection
àà 
sqlConnection
àà '
=
àà( )
new
àà* -
SqlConnection
àà. ;
(
àà; <
)
àà< =
;
àà= >
try
ää 
{
ãã 
sqlConnection
çç 
=
çç 
Conexion
çç  (
.
çç( )
getInstance
çç) 4
(
çç4 5
)
çç5 6
.
çç6 7 
EstablecerConexion
çç7 I
(
ççI J
)
ççJ K
;
ççK L

SqlCommand
èè 
comando
èè "
=
èè# $
new
èè% (

SqlCommand
èè) 3
(
èè3 4
$str
èè4 M
,
èèM N
sqlConnection
èèO \
)
èè\ ]
;
èè] ^
comando
ëë 
.
ëë 
CommandType
ëë #
=
ëë$ %
CommandType
ëë& 1
.
ëë1 2
StoredProcedure
ëë2 A
;
ëëA B
comando
ìì 
.
ìì 

Parameters
ìì "
.
ìì" #
Add
ìì# &
(
ìì& '
$str
ìì' .
,
ìì. /
	SqlDbType
ìì0 9
.
ìì9 :
Int
ìì: =
)
ìì= >
.
ìì> ?
Value
ìì? D
=
ììE F
Dni
ììG J
;
ììJ K
sqlConnection
ïï 
.
ïï 
Open
ïï "
(
ïï" #
)
ïï# $
;
ïï$ %
Rpta
óó 
=
óó 
comando
óó 
.
óó 
ExecuteNonQuery
óó .
(
óó. /
)
óó/ 0
==
óó1 3
$num
óó4 5
?
óó6 7
$str
óó8 B
:
óóC D
$str
óóE h
;
óóh i
}
òò 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
öö 
Rpta
õõ 
=
õõ 
ex
õõ 
.
õõ 
Message
õõ !
;
õõ! "
}
úú 
finally
ùù 
{
ûû 
if
üü 
(
üü 
sqlConnection
üü !
.
üü! "
State
üü" '
==
üü( *
ConnectionState
üü+ :
.
üü: ;
Open
üü; ?
)
üü? @
sqlConnection
üüA N
.
üüN O
Close
üüO T
(
üüT U
)
üüU V
;
üüV W
}
†† 
return
°° 
Rpta
°° 
;
°° 
}
¢¢ 	
}
££ 
}§§ Œ)
WD:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\EnfermedadPosibleDatos.cs
	namespace 	
SistemaDiagnostico
 
. 
AccesoDatos (
{ 
public 

class "
EnfermedadPosibleDatos '
{ 
public 
string 
Insertar 
( $
EnfermedadPosibleEntidad 7
objDiagnostico8 F
)F G
{ 	
string 
Rpta 
= 
$str 
; 
SqlConnection 
sqlConnection '
=( )
new* -
SqlConnection. ;
(; <
)< =
;= >
try 
{ 
sqlConnection 
= 
Conexion  (
.( )
getInstance) 4
(4 5
)5 6
.6 7
EstablecerConexion7 I
(I J
)J K
;K L

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 N
,N O
sqlConnectionP ]
)] ^
;^ _
comando 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
comando 
. 

Parameters "
." #
Add# &
(& '
$str' 9
,9 :
	SqlDbType; D
.D E
IntE H
)H I
.I J
ValueJ O
=P Q
objDiagnosticoR `
.` a
DiagnosticoIda n
;n o
comando   
.   

Parameters   "
.  " #
Add  # &
(  & '
$str  ' 9
,  9 :
	SqlDbType  ; D
.  D E
VarChar  E L
)  L M
.  M N
Value  N S
=  T U
objDiagnostico  V d
.  d e
PosEnfermedad  e r
;  r s
sqlConnection"" 
."" 
Open"" "
(""" #
)""# $
;""$ %
Rpta$$ 
=$$ 
comando$$ 
.$$ 
ExecuteNonQuery$$ .
($$. /
)$$/ 0
==$$1 3
$num$$4 5
?$$6 7
$str$$8 B
:$$C D
$str$$E f
;$$f g
}%% 
catch&& 
(&& 
	Exception&& 
ex&& 
)&&  
{'' 
Rpta(( 
=(( 
ex(( 
.(( 
Message(( !
;((! "
})) 
finally** 
{++ 
if,, 
(,, 
sqlConnection,, !
.,,! "
State,," '
==,,( *
ConnectionState,,+ :
.,,: ;
Open,,; ?
),,? @
sqlConnection,,A N
.,,N O
Close,,O T
(,,T U
),,U V
;,,V W
}-- 
return.. 
Rpta.. 
;.. 
}// 	
public22 
string22 
Eliminar22 
(22 
int22 "
Id22# %
)22% &
{33 	
string44 
Rpta44 
=44 
$str44 
;44 
SqlConnection66 
sqlConnection66 '
=66( )
new66* -
SqlConnection66. ;
(66; <
)66< =
;66= >
try88 
{99 
sqlConnection;; 
=;; 
Conexion;;  (
.;;( )
getInstance;;) 4
(;;4 5
);;5 6
.;;6 7
EstablecerConexion;;7 I
(;;I J
);;J K
;;;K L

SqlCommand== 
comando== "
===# $
new==% (

SqlCommand==) 3
(==3 4
$str==4 N
,==N O
sqlConnection==P ]
)==] ^
;==^ _
comando?? 
.?? 
CommandType?? #
=??$ %
CommandType??& 1
.??1 2
StoredProcedure??2 A
;??A B
comandoAA 
.AA 

ParametersAA "
.AA" #
AddAA# &
(AA& '
$strAA' 9
,AA9 :
	SqlDbTypeAA; D
.AAD E
IntAAE H
)AAH I
.AAI J
ValueAAJ O
=AAP Q
IdAAR T
;AAT U
sqlConnectionCC 
.CC 
OpenCC "
(CC" #
)CC# $
;CC$ %
RptaEE 
=EE 
comandoEE 
.EE 
ExecuteNonQueryEE .
(EE. /
)EE/ 0
==EE1 3
$numEE4 5
?EE6 7
$strEE8 B
:EEC D
$strEEE f
;EEf g
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
RptaII 
=II 
exII 
.II 
MessageII !
;II! "
}JJ 
finallyKK 
{LL 
ifMM 
(MM 
sqlConnectionMM !
.MM! "
StateMM" '
==MM( *
ConnectionStateMM+ :
.MM: ;
OpenMM; ?
)MM? @
sqlConnectionMMA N
.MMN O
CloseMMO T
(MMT U
)MMU V
;MMV W
}NN 
returnOO 
RptaOO 
;OO 
}PP 	
}QQ 
}RR ﬁΩ
ND:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\PacienteDatos.cs
	namespace

 	
SistemaDiagnostico


 
.

 
AccesoDatos

 (
{ 
public 

class 
PacienteDatos 
{ 
public 
string 
Insertar 
( 
PacienteEntidad .
objPaciente/ :
): ;
{ 	
string 
Rpta 
= 
$str 
; 
SqlConnection 
sqlCnx  
=! "
new# &
SqlConnection' 4
(4 5
)5 6
;6 7
try 
{ 
sqlCnx 
= 
Conexion !
.! "
getInstance" -
(- .
). /
./ 0
EstablecerConexion0 B
(B C
)C D
;D E

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 D
,D E
sqlCnxF L
)L M
;M N
comando 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
comando 
. 

Parameters "
." #
Add# &
(& '
$str' .
,. /
	SqlDbType0 9
.9 :
Char: >
)> ?
.? @
Value@ E
=F G
objPacienteH S
.S T
DniT W
;W X
comando 
. 

Parameters "
." #
Add# &
(& '
$str' 1
,1 2
	SqlDbType3 <
.< =
VarChar= D
)D E
.E F
ValueF K
=L M
objPacienteN Y
.Y Z
NombreZ `
;` a
comando 
. 

Parameters "
." #
Add# &
(& '
$str' 3
,3 4
	SqlDbType5 >
.> ?
VarChar? F
)F G
.G H
ValueH M
=N O
objPacienteP [
.[ \
Apellido\ d
;d e
comando   
.   

Parameters   "
.  " #
Add  # &
(  & '
$str  ' /
,  / 0
	SqlDbType  1 :
.  : ;
VarChar  ; B
)  B C
.  C D
Value  D I
=  J K
objPaciente  L W
.  W X
Sexo  X \
;  \ ]
comando!! 
.!! 

Parameters!! "
.!!" #
Add!!# &
(!!& '
$str!!' 4
,!!4 5
	SqlDbType!!6 ?
.!!? @
Text!!@ D
)!!D E
.!!E F
Value!!F K
=!!L M
objPaciente!!N Y
.!!Y Z
	Direccion!!Z c
;!!c d
comando"" 
."" 

Parameters"" "
.""" #
Add""# &
(""& '
$str""' 2
,""2 3
	SqlDbType""4 =
.""= >
Char""> B
)""B C
.""C D
Value""D I
=""J K
objPaciente""L W
.""W X
Celular""X _
;""_ `
comando## 
.## 

Parameters## "
.##" #
Add### &
(##& '
$str##' 1
,##1 2
	SqlDbType##3 <
.##< =
Char##= A
)##A B
.##B C
Value##C H
=##I J
objPaciente##K V
.##V W
Estado##W ]
;##] ^
sqlCnx%% 
.%% 
Open%% 
(%% 
)%% 
;%% 
Rpta'' 
='' 
comando'' 
.'' 
ExecuteNonQuery'' .
(''. /
)''/ 0
==''1 3
$num''4 5
?''6 7
$str''8 B
:''C D
$str''E g
;''g h
})) 
catch** 
(** 
	Exception** 
ex** 
)**  
{++ 
Rpta,, 
=,, 
ex,, 
.,, 
Message,, !
;,,! "
}-- 
finally.. 
{// 
if00 
(00 
sqlCnx00 
.00 
State00  
==00! #
ConnectionState00$ 3
.003 4
Open004 8
)008 9
sqlCnx00: @
.00@ A
Close00A F
(00F G
)00G H
;00H I
}11 
return22 
Rpta22 
;22 
}33 	
public66 
string66 

Actualizar66  
(66  !
PacienteEntidad66! 0
objPaciente661 <
)66< =
{77 	
string88 
Rpta88 
=88 
$str88 
;88 
SqlConnection99 
sqlCnx99  
=99! "
new99# &
SqlConnection99' 4
(994 5
)995 6
;996 7
try;; 
{<< 
sqlCnx>> 
=>> 
Conexion>> !
.>>! "
getInstance>>" -
(>>- .
)>>. /
.>>/ 0
EstablecerConexion>>0 B
(>>B C
)>>C D
;>>D E

SqlCommand@@ 
comando@@ "
=@@# $
new@@% (

SqlCommand@@) 3
(@@3 4
$str@@4 D
,@@D E
sqlCnx@@F L
)@@L M
;@@M N
comandoBB 
.BB 
CommandTypeBB #
=BB$ %
CommandTypeBB& 1
.BB1 2
StoredProcedureBB2 A
;BBA B
comandoDD 
.DD 

ParametersDD "
.DD" #
AddDD# &
(DD& '
$strDD' .
,DD. /
	SqlDbTypeDD0 9
.DD9 :
CharDD: >
)DD> ?
.DD? @
ValueDD@ E
=DDF G
objPacienteDDH S
.DDS T
DniDDT W
;DDW X
comandoEE 
.EE 

ParametersEE "
.EE" #
AddEE# &
(EE& '
$strEE' 1
,EE1 2
	SqlDbTypeEE3 <
.EE< =
VarCharEE= D
)EED E
.EEE F
ValueEEF K
=EEL M
objPacienteEEN Y
.EEY Z
NombreEEZ `
;EE` a
comandoFF 
.FF 

ParametersFF "
.FF" #
AddFF# &
(FF& '
$strFF' 3
,FF3 4
	SqlDbTypeFF5 >
.FF> ?
VarCharFF? F
)FFF G
.FFG H
ValueFFH M
=FFN O
objPacienteFFP [
.FF[ \
ApellidoFF\ d
;FFd e
comandoGG 
.GG 

ParametersGG "
.GG" #
AddGG# &
(GG& '
$strGG' /
,GG/ 0
	SqlDbTypeGG1 :
.GG: ;
VarCharGG; B
)GGB C
.GGC D
ValueGGD I
=GGJ K
objPacienteGGL W
.GGW X
SexoGGX \
;GG\ ]
comandoHH 
.HH 

ParametersHH "
.HH" #
AddHH# &
(HH& '
$strHH' 4
,HH4 5
	SqlDbTypeHH6 ?
.HH? @
TextHH@ D
)HHD E
.HHE F
ValueHHF K
=HHL M
objPacienteHHN Y
.HHY Z
	DireccionHHZ c
;HHc d
comandoII 
.II 

ParametersII "
.II" #
AddII# &
(II& '
$strII' 2
,II2 3
	SqlDbTypeII4 =
.II= >
CharII> B
)IIB C
.IIC D
ValueIID I
=IIJ K
objPacienteIIL W
.IIW X
CelularIIX _
;II_ `
comandoJJ 
.JJ 

ParametersJJ "
.JJ" #
AddJJ# &
(JJ& '
$strJJ' 1
,JJ1 2
	SqlDbTypeJJ3 <
.JJ< =
CharJJ= A
)JJA B
.JJB C
ValueJJC H
=JJI J
objPacienteJJK V
.JJV W
EstadoJJW ]
;JJ] ^
sqlCnxLL 
.LL 
OpenLL 
(LL 
)LL 
;LL 
RptaNN 
=NN 
comandoNN 
.NN 
ExecuteNonQueryNN .
(NN. /
)NN/ 0
==NN1 3
$numNN4 5
?NN6 7
$strNN8 B
:NNC D
$strNNE i
;NNi j
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
exQQ 
)QQ  
{RR 
RptaSS 
=SS 
exSS 
.SS 
MessageSS !
;SS! "
}TT 
finallyUU 
{VV 
ifWW 
(WW 
sqlCnxWW 
.WW 
StateWW  
==WW! #
ConnectionStateWW$ 3
.WW3 4
OpenWW4 8
)WW8 9
sqlCnxWW: @
.WW@ A
CloseWWA F
(WWF G
)WWG H
;WWH I
}XX 
returnYY 
RptaYY 
;YY 
}ZZ 	
public]] 
string]] 
Existe]] 
(]] 
string]] #
Valor]]$ )
)]]) *
{^^ 	
string__ 
Rpta__ 
=__ 
$str__ 
;__ 
SqlConnection`` 
sqlCnx``  
=``! "
new``# &
SqlConnection``' 4
(``4 5
)``5 6
;``6 7
trybb 
{cc 
sqlCnxee 
=ee 
Conexionee !
.ee! "
getInstanceee" -
(ee- .
)ee. /
.ee/ 0
EstablecerConexionee0 B
(eeB C
)eeC D
;eeD E

SqlCommandgg 
comandogg "
=gg# $
newgg% (

SqlCommandgg) 3
(gg3 4
$strgg4 L
,ggL M
sqlCnxggN T
)ggT U
;ggU V
comandoii 
.ii 
CommandTypeii #
=ii$ %
CommandTypeii& 1
.ii1 2
StoredProcedureii2 A
;iiA B
comandokk 
.kk 

Parameterskk "
.kk" #
Addkk# &
(kk& '
$strkk' 0
,kk0 1
	SqlDbTypekk2 ;
.kk; <
VarCharkk< C
)kkC D
.kkD E
ValuekkE J
=kkK L
ValorkkM R
;kkR S
SqlParameterll 
PExistell $
=ll% &
newll' *
SqlParameterll+ 7
(ll7 8
)ll8 9
;ll9 :
PExistemm 
.mm 
ParameterNamemm %
=mm& '
$strmm( 2
;mm2 3
PExistenn 
.nn 
	SqlDbTypenn !
=nn" #
	SqlDbTypenn$ -
.nn- .
Intnn. 1
;nn1 2
PExisteoo 
.oo 
	Directionoo !
=oo" #
ParameterDirectionoo$ 6
.oo6 7
Outputoo7 =
;oo= >
comandoqq 
.qq 

Parametersqq "
.qq" #
Addqq# &
(qq& '
PExisteqq' .
)qq. /
;qq/ 0
sqlCnxrr 
.rr 
Openrr 
(rr 
)rr 
;rr 
Rptatt 
=tt 
Converttt 
.tt 
ToStringtt '
(tt' (
PExistett( /
.tt/ 0
Valuett0 5
)tt5 6
;tt6 7
}vv 
catchww 
(ww 
	Exceptionww 
exww 
)ww  
{xx 
Rptayy 
=yy 
exyy 
.yy 
Messageyy !
;yy! "
}zz 
finally{{ 
{|| 
if}} 
(}} 
sqlCnx}} 
.}} 
State}}  
==}}! #
ConnectionState}}$ 3
.}}3 4
Open}}4 8
)}}8 9
sqlCnx}}: @
.}}@ A
Close}}A F
(}}F G
)}}G H
;}}H I
}~~ 
return 
Rpta 
; 
}
ÄÄ 	
public
ÉÉ 
	DataTable
ÉÉ 
Listar
ÉÉ 
(
ÉÉ  
)
ÉÉ  !
{
ÑÑ 	
SqlDataReader
ÖÖ 
	Resultado
ÖÖ #
;
ÖÖ# $
	DataTable
ÜÜ 
Tabla
ÜÜ 
=
ÜÜ 
new
ÜÜ !
	DataTable
ÜÜ" +
(
ÜÜ+ ,
)
ÜÜ, -
;
ÜÜ- .
SqlConnection
áá 
sqlCnx
áá  
=
áá! "
new
áá# &
SqlConnection
áá' 4
(
áá4 5
)
áá5 6
;
áá6 7
try
ââ 
{
ää 
sqlCnx
åå 
=
åå 
Conexion
åå !
.
åå! "
getInstance
åå" -
(
åå- .
)
åå. /
.
åå/ 0 
EstablecerConexion
åå0 B
(
ååB C
)
ååC D
;
ååD E

SqlCommand
éé 
comando
éé "
=
éé# $
new
éé% (

SqlCommand
éé) 3
(
éé3 4
$str
éé4 D
,
ééD E
sqlCnx
ééF L
)
ééL M
;
ééM N
comando
êê 
.
êê 
CommandType
êê #
=
êê$ %
CommandType
êê& 1
.
êê1 2
StoredProcedure
êê2 A
;
êêA B
sqlCnx
ëë 
.
ëë 
Open
ëë 
(
ëë 
)
ëë 
;
ëë 
	Resultado
íí 
=
íí 
comando
íí #
.
íí# $
ExecuteReader
íí$ 1
(
íí1 2
)
íí2 3
;
íí3 4
Tabla
ìì 
.
ìì 
Load
ìì 
(
ìì 
	Resultado
ìì $
)
ìì$ %
;
ìì% &
return
îî 
Tabla
îî 
;
îî 
}
ññ 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
òò 
throw
ôô 
ex
ôô 
;
ôô 
}
öö 
finally
õõ 
{
úú 
if
ùù 
(
ùù 
sqlCnx
ùù 
.
ùù 
State
ùù  
==
ùù! #
ConnectionState
ùù$ 3
.
ùù3 4
Open
ùù4 8
)
ùù8 9
sqlCnx
ùù: @
.
ùù@ A
Close
ùùA F
(
ùùF G
)
ùùG H
;
ùùH I
}
ûû 
}
üü 	
public
°° 
	DataTable
°° 
Buscar
°° 
(
°°  
string
°°  &
Busqueda
°°' /
)
°°/ 0
{
¢¢ 	
SqlDataReader
££ 
	Resultado
££ #
;
££# $
	DataTable
§§ 
Tabla
§§ 
=
§§ 
new
§§ !
	DataTable
§§" +
(
§§+ ,
)
§§, -
;
§§- .
SqlConnection
•• 
sqlCnx
••  
=
••! "
new
••# &
SqlConnection
••' 4
(
••4 5
)
••5 6
;
••6 7
try
ßß 
{
®® 
sqlCnx
™™ 
=
™™ 
Conexion
™™ !
.
™™! "
getInstance
™™" -
(
™™- .
)
™™. /
.
™™/ 0 
EstablecerConexion
™™0 B
(
™™B C
)
™™C D
;
™™D E

SqlCommand
¨¨ 
comando
¨¨ "
=
¨¨# $
new
¨¨% (

SqlCommand
¨¨) 3
(
¨¨3 4
$str
¨¨4 M
,
¨¨M N
sqlCnx
¨¨O U
)
¨¨U V
;
¨¨V W
comando
ÆÆ 
.
ÆÆ 
CommandType
ÆÆ #
=
ÆÆ$ %
CommandType
ÆÆ& 1
.
ÆÆ1 2
StoredProcedure
ÆÆ2 A
;
ÆÆA B
comando
∞∞ 
.
∞∞ 

Parameters
∞∞ "
.
∞∞" #
Add
∞∞# &
(
∞∞& '
$str
∞∞' 3
,
∞∞3 4
	SqlDbType
∞∞5 >
.
∞∞> ?
VarChar
∞∞? F
)
∞∞F G
.
∞∞G H
Value
∞∞H M
=
∞∞N O
Busqueda
∞∞P X
;
∞∞X Y
sqlCnx
±± 
.
±± 
Open
±± 
(
±± 
)
±± 
;
±± 
	Resultado
≤≤ 
=
≤≤ 
comando
≤≤ #
.
≤≤# $
ExecuteReader
≤≤$ 1
(
≤≤1 2
)
≤≤2 3
;
≤≤3 4
Tabla
≥≥ 
.
≥≥ 
Load
≥≥ 
(
≥≥ 
	Resultado
≥≥ $
)
≥≥$ %
;
≥≥% &
return
¥¥ 
Tabla
¥¥ 
;
¥¥ 
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑  
{
∏∏ 
throw
ππ 
ex
ππ 
;
ππ 
}
∫∫ 
finally
ªª 
{
ºº 
if
ΩΩ 
(
ΩΩ 
sqlCnx
ΩΩ 
.
ΩΩ 
State
ΩΩ  
==
ΩΩ! #
ConnectionState
ΩΩ$ 3
.
ΩΩ3 4
Open
ΩΩ4 8
)
ΩΩ8 9
sqlCnx
ΩΩ: @
.
ΩΩ@ A
Close
ΩΩA F
(
ΩΩF G
)
ΩΩG H
;
ΩΩH I
}
ææ 
}
øø 	
public
¬¬ 
string
¬¬ 
Eliminar
¬¬ 
(
¬¬ 
string
¬¬ %
Dni
¬¬& )
)
¬¬) *
{
√√ 	
string
ƒƒ 
Rpta
ƒƒ 
=
ƒƒ 
$str
ƒƒ 
;
ƒƒ 
SqlConnection
≈≈ 
sqlCnx
≈≈  
=
≈≈! "
new
≈≈# &
SqlConnection
≈≈' 4
(
≈≈4 5
)
≈≈5 6
;
≈≈6 7
try
«« 
{
»» 
sqlCnx
   
=
   
Conexion
   !
.
  ! "
getInstance
  " -
(
  - .
)
  . /
.
  / 0 
EstablecerConexion
  0 B
(
  B C
)
  C D
;
  D E

SqlCommand
ÃÃ 
comando
ÃÃ "
=
ÃÃ# $
new
ÃÃ% (

SqlCommand
ÃÃ) 3
(
ÃÃ3 4
$str
ÃÃ4 D
,
ÃÃD E
sqlCnx
ÃÃF L
)
ÃÃL M
;
ÃÃM N
comando
ŒŒ 
.
ŒŒ 
CommandType
ŒŒ #
=
ŒŒ$ %
CommandType
ŒŒ& 1
.
ŒŒ1 2
StoredProcedure
ŒŒ2 A
;
ŒŒA B
comando
–– 
.
–– 

Parameters
–– "
.
––" #
Add
––# &
(
––& '
$str
––' .
,
––. /
	SqlDbType
––0 9
.
––9 :
Char
––: >
)
––> ?
.
––? @
Value
––@ E
=
––F G
Dni
––H K
;
––K L
sqlCnx
““ 
.
““ 
Open
““ 
(
““ 
)
““ 
;
““ 
Rpta
‘‘ 
=
‘‘ 
comando
‘‘ 
.
‘‘ 
ExecuteNonQuery
‘‘ .
(
‘‘. /
)
‘‘/ 0
==
‘‘1 3
$num
‘‘4 5
?
‘‘6 7
$str
‘‘8 B
:
‘‘C D
$str
‘‘E g
;
‘‘g h
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ 
ex
◊◊ 
)
◊◊  
{
ÿÿ 
Rpta
ŸŸ 
=
ŸŸ 
ex
ŸŸ 
.
ŸŸ 
Message
ŸŸ !
;
ŸŸ! "
}
⁄⁄ 
finally
€€ 
{
‹‹ 
if
›› 
(
›› 
sqlCnx
›› 
.
›› 
State
››  
==
››! #
ConnectionState
››$ 3
.
››3 4
Open
››4 8
)
››8 9
sqlCnx
››: @
.
››@ A
Close
››A F
(
››F G
)
››G H
;
››H I
}
ﬁﬁ 
return
ﬂﬂ 
Rpta
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 	
public
„„ 
string
„„ 
Activar
„„ 
(
„„ 
int
„„ !
Dni
„„" %
)
„„% &
{
‰‰ 	
string
ÂÂ 
Rpta
ÂÂ 
=
ÂÂ 
$str
ÂÂ 
;
ÂÂ 
SqlConnection
ÊÊ 
sqlCnx
ÊÊ  
=
ÊÊ! "
new
ÊÊ# &
SqlConnection
ÊÊ' 4
(
ÊÊ4 5
)
ÊÊ5 6
;
ÊÊ6 7
try
ËË 
{
ÈÈ 
sqlCnx
ÎÎ 
=
ÎÎ 
Conexion
ÎÎ !
.
ÎÎ! "
getInstance
ÎÎ" -
(
ÎÎ- .
)
ÎÎ. /
.
ÎÎ/ 0 
EstablecerConexion
ÎÎ0 B
(
ÎÎB C
)
ÎÎC D
;
ÎÎD E

SqlCommand
ÌÌ 
comando
ÌÌ "
=
ÌÌ# $
new
ÌÌ% (

SqlCommand
ÌÌ) 3
(
ÌÌ3 4
$str
ÌÌ4 J
,
ÌÌJ K
sqlCnx
ÌÌL R
)
ÌÌR S
;
ÌÌS T
comando
ÔÔ 
.
ÔÔ 
CommandType
ÔÔ #
=
ÔÔ$ %
CommandType
ÔÔ& 1
.
ÔÔ1 2
StoredProcedure
ÔÔ2 A
;
ÔÔA B
comando
ÒÒ 
.
ÒÒ 

Parameters
ÒÒ "
.
ÒÒ" #
Add
ÒÒ# &
(
ÒÒ& '
$str
ÒÒ' .
,
ÒÒ. /
	SqlDbType
ÒÒ0 9
.
ÒÒ9 :
Int
ÒÒ: =
)
ÒÒ= >
.
ÒÒ> ?
Value
ÒÒ? D
=
ÒÒE F
Dni
ÒÒG J
;
ÒÒJ K
sqlCnx
ÛÛ 
.
ÛÛ 
Open
ÛÛ 
(
ÛÛ 
)
ÛÛ 
;
ÛÛ 
Rpta
ıı 
=
ıı 
comando
ıı 
.
ıı 
ExecuteNonQuery
ıı .
(
ıı. /
)
ıı/ 0
==
ıı1 3
$num
ıı4 5
?
ıı6 7
$str
ıı8 B
:
ııC D
$str
ııE f
;
ııf g
}
˜˜ 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
˘˘ 
Rpta
˙˙ 
=
˙˙ 
ex
˙˙ 
.
˙˙ 
Message
˙˙ !
;
˙˙! "
}
˚˚ 
finally
¸¸ 
{
˝˝ 
if
˛˛ 
(
˛˛ 
sqlCnx
˛˛ 
.
˛˛ 
State
˛˛  
==
˛˛! #
ConnectionState
˛˛$ 3
.
˛˛3 4
Open
˛˛4 8
)
˛˛8 9
sqlCnx
˛˛: @
.
˛˛@ A
Close
˛˛A F
(
˛˛F G
)
˛˛G H
;
˛˛H I
}
ˇˇ 
return
ÄÄ 
Rpta
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
public
ÑÑ 
string
ÑÑ 

Desactivar
ÑÑ  
(
ÑÑ  !
int
ÑÑ! $
Dni
ÑÑ% (
)
ÑÑ( )
{
ÖÖ 	
string
ÜÜ 
Rpta
ÜÜ 
=
ÜÜ 
$str
ÜÜ 
;
ÜÜ 
SqlConnection
áá 
sqlCnx
áá  
=
áá! "
new
áá# &
SqlConnection
áá' 4
(
áá4 5
)
áá5 6
;
áá6 7
try
ââ 
{
ää 
sqlCnx
åå 
=
åå 
Conexion
åå !
.
åå! "
getInstance
åå" -
(
åå- .
)
åå. /
.
åå/ 0 
EstablecerConexion
åå0 B
(
ååB C
)
ååC D
;
ååD E

SqlCommand
éé 
comando
éé "
=
éé# $
new
éé% (

SqlCommand
éé) 3
(
éé3 4
$str
éé4 M
,
ééM N
sqlCnx
ééO U
)
ééU V
;
ééV W
comando
êê 
.
êê 
CommandType
êê #
=
êê$ %
CommandType
êê& 1
.
êê1 2
StoredProcedure
êê2 A
;
êêA B
comando
íí 
.
íí 

Parameters
íí "
.
íí" #
Add
íí# &
(
íí& '
$str
íí' .
,
íí. /
	SqlDbType
íí0 9
.
íí9 :
Int
íí: =
)
íí= >
.
íí> ?
Value
íí? D
=
ííE F
Dni
ííG J
;
ííJ K
sqlCnx
îî 
.
îî 
Open
îî 
(
îî 
)
îî 
;
îî 
Rpta
ññ 
=
ññ 
comando
ññ 
.
ññ 
ExecuteNonQuery
ññ .
(
ññ. /
)
ññ/ 0
==
ññ1 3
$num
ññ4 5
?
ññ6 7
$str
ññ8 B
:
ññC D
$str
ññE i
;
ññi j
}
òò 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
öö 
Rpta
õõ 
=
õõ 
ex
õõ 
.
õõ 
Message
õõ !
;
õõ! "
}
úú 
finally
ùù 
{
ûû 
if
üü 
(
üü 
sqlCnx
üü 
.
üü 
State
üü  
==
üü! #
ConnectionState
üü$ 3
.
üü3 4
Open
üü4 8
)
üü8 9
sqlCnx
üü: @
.
üü@ A
Close
üüA F
(
üüF G
)
üüG H
;
üüH I
}
†† 
return
°° 
Rpta
°° 
;
°° 
}
¢¢ 	
}
££ 
}§§ É
XD:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 9
)9 :
]: ;
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str ;
); <
]< =
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *£ﬁ
MD:\Proyecto\SistemaDiagnostico\SistemaDiagnostico.AccesoDatos\UsuarioDatos.cs
	namespace 	
SistemaDiagnostico
 
. 
AccesoDatos (
{ 
public 

class 
UsuarioDatos 
{ 
public 
	DataTable 
Login 
( 
string %
Usuario& -
,- .
string/ 5
Password6 >
)> ?
{ 	
SqlDataReader 
	Resultado #
;# $
	DataTable 
tabla 
= 
new !
	DataTable" +
(+ ,
), -
;- .
SqlConnection 
sqlCnx  
=! "
new# &
SqlConnection' 4
(4 5
)5 6
;6 7
try 
{ 
sqlCnx 
= 
Conexion !
.! "
getInstance" -
(- .
). /
./ 0
EstablecerConexion0 B
(B C
)C D
;D E

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 G
,G H
sqlCnxI O
)O P
;P Q
comando 
. 
CommandType #
=$ %
CommandType& 1
.1 2
StoredProcedure2 A
;A B
comando 
. 

Parameters "
." #
Add# &
(& '
$str' 2
,2 3
	SqlDbType4 =
.= >
VarChar> E
)E F
.F G
ValueG L
=M N
UsuarioO V
;V W
comando   
.   

Parameters   "
.  " #
Add  # &
(  & '
$str  ' 3
,  3 4
	SqlDbType  5 >
.  > ?
VarChar  ? F
)  F G
.  G H
Value  H M
=  N O
Password  P X
;  X Y
sqlCnx!! 
.!! 
Open!! 
(!! 
)!! 
;!! 
	Resultado"" 
="" 
comando"" #
.""# $
ExecuteReader""$ 1
(""1 2
)""2 3
;""3 4
tabla## 
.## 
Load## 
(## 
	Resultado## $
)##$ %
;##% &
return$$ 
tabla$$ 
;$$ 
}&& 
catch'' 
('' 
	Exception'' 
ex'' 
)''  
{(( 
throw)) 
ex)) 
;)) 
}** 
finally++ 
{,, 
if-- 
(-- 
sqlCnx-- 
.-- 
State--  
==--! #
ConnectionState--$ 3
.--3 4
Open--4 8
)--8 9
sqlCnx--: @
.--@ A
Close--A F
(--F G
)--G H
;--H I
}.. 
}00 	
public44 
	DataTable44 
LoginVerificar44 '
(44' (
string44( .
Busqueda44/ 7
)447 8
{55 	
SqlDataReader66 
	Resultado66 #
;66# $
	DataTable77 
tabla77 
=77 
new77 !
	DataTable77" +
(77+ ,
)77, -
;77- .
SqlConnection88 
sqlCnx88  
=88! "
new88# &
SqlConnection88' 4
(884 5
)885 6
;886 7
try:: 
{;; 
sqlCnx== 
=== 
Conexion== !
.==! "
getInstance==" -
(==- .
)==. /
.==/ 0
EstablecerConexion==0 B
(==B C
)==C D
;==D E

SqlCommand?? 
comando?? "
=??# $
new??% (

SqlCommand??) 3
(??3 4
$str??4 I
,??I J
sqlCnx??K Q
)??Q R
;??R S
comando@@ 
.@@ 
CommandType@@ #
=@@$ %
CommandType@@& 1
.@@1 2
StoredProcedure@@2 A
;@@A B
comandoAA 
.AA 

ParametersAA "
.AA" #
AddAA# &
(AA& '
$strAA' 3
,AA3 4
	SqlDbTypeAA5 >
.AA> ?
VarCharAA? F
)AAF G
.AAG H
ValueAAH M
=AAN O
BusquedaAAP X
;AAX Y
sqlCnxBB 
.BB 
OpenBB 
(BB 
)BB 
;BB 
	ResultadoCC 
=CC 
comandoCC #
.CC# $
ExecuteReaderCC$ 1
(CC1 2
)CC2 3
;CC3 4
tablaDD 
.DD 
LoadDD 
(DD 
	ResultadoDD $
)DD$ %
;DD% &
returnEE 
tablaEE 
;EE 
}GG 
catchHH 
(HH 
	ExceptionHH 
exHH 
)HH  
{II 
throwJJ 
exJJ 
;JJ 
}KK 
finallyLL 
{MM 
ifNN 
(NN 
sqlCnxNN 
.NN 
StateNN  
==NN! #
ConnectionStateNN$ 3
.NN3 4
OpenNN4 8
)NN8 9
sqlCnxNN: @
.NN@ A
CloseNNA F
(NNF G
)NNG H
;NNH I
}OO 
}QQ 	
publicTT 
	DataTableTT 
ListarTT 
(TT  
)TT  !
{UU 	
SqlDataReaderVV 
	ResultadoVV #
;VV# $
	DataTableWW 
tablaWW 
=WW 
newWW !
	DataTableWW" +
(WW+ ,
)WW, -
;WW- .
SqlConnectionXX 
sqlCnxXX  
=XX! "
newXX# &
SqlConnectionXX' 4
(XX4 5
)XX5 6
;XX6 7
tryZZ 
{[[ 
sqlCnx]] 
=]] 
Conexion]] !
.]]! "
getInstance]]" -
(]]- .
)]]. /
.]]/ 0
EstablecerConexion]]0 B
(]]B C
)]]C D
;]]D E

SqlCommand__ 
comando__ "
=__# $
new__% (

SqlCommand__) 3
(__3 4
$str__4 C
,__C D
sqlCnx__E K
)__K L
;__L M
comando`` 
.`` 
CommandType`` #
=``$ %
CommandType``& 1
.``1 2
StoredProcedure``2 A
;``A B
sqlCnxaa 
.aa 
Openaa 
(aa 
)aa 
;aa 
	Resultadobb 
=bb 
comandobb #
.bb# $
ExecuteReaderbb$ 1
(bb1 2
)bb2 3
;bb3 4
tablacc 
.cc 
Loadcc 
(cc 
	Resultadocc $
)cc$ %
;cc% &
returndd 
tabladd 
;dd 
}ff 
catchgg 
(gg 
	Exceptiongg 
exgg 
)gg  
{hh 
throwii 
exii 
;ii 
}jj 
finallykk 
{ll 
ifmm 
(mm 
sqlCnxmm 
.mm 
Statemm  
==mm! #
ConnectionStatemm$ 3
.mm3 4
Openmm4 8
)mm8 9
sqlCnxmm: @
.mm@ A
ClosemmA F
(mmF G
)mmG H
;mmH I
}nn 
}pp 	
publictt 
	DataTablett 
Buscartt 
(tt  
stringtt  &
Busquedatt' /
)tt/ 0
{uu 	
SqlDataReadervv 
	Resultadovv #
;vv# $
	DataTableww 
tablaww 
=ww 
newww !
	DataTableww" +
(ww+ ,
)ww, -
;ww- .
SqlConnectionxx 
sqlCnxxx  
=xx! "
newxx# &
SqlConnectionxx' 4
(xx4 5
)xx5 6
;xx6 7
tryzz 
{{{ 
sqlCnx}} 
=}} 
Conexion}} !
.}}! "
getInstance}}" -
(}}- .
)}}. /
.}}/ 0
EstablecerConexion}}0 B
(}}B C
)}}C D
;}}D E

SqlCommand 
comando "
=# $
new% (

SqlCommand) 3
(3 4
$str4 L
,L M
sqlCnxN T
)T U
;U V
comando
ÅÅ 
.
ÅÅ 
CommandType
ÅÅ #
=
ÅÅ$ %
CommandType
ÅÅ& 1
.
ÅÅ1 2
StoredProcedure
ÅÅ2 A
;
ÅÅA B
comando
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ "
.
ÉÉ" #
Add
ÉÉ# &
(
ÉÉ& '
$str
ÉÉ' 3
,
ÉÉ3 4
	SqlDbType
ÉÉ5 >
.
ÉÉ> ?
VarChar
ÉÉ? F
)
ÉÉF G
.
ÉÉG H
Value
ÉÉH M
=
ÉÉN O
Busqueda
ÉÉP X
;
ÉÉX Y
sqlCnx
ÑÑ 
.
ÑÑ 
Open
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
	Resultado
ÖÖ 
=
ÖÖ 
comando
ÖÖ #
.
ÖÖ# $
ExecuteReader
ÖÖ$ 1
(
ÖÖ1 2
)
ÖÖ2 3
;
ÖÖ3 4
tabla
ÜÜ 
.
ÜÜ 
Load
ÜÜ 
(
ÜÜ 
	Resultado
ÜÜ $
)
ÜÜ$ %
;
ÜÜ% &
return
áá 
tabla
áá 
;
áá 
}
ââ 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
ãã 
throw
åå 
ex
åå 
;
åå 
}
çç 
finally
éé 
{
èè 
if
êê 
(
êê 
sqlCnx
êê 
.
êê 
State
êê  
==
êê! #
ConnectionState
êê$ 3
.
êê3 4
Open
êê4 8
)
êê8 9
sqlCnx
êê: @
.
êê@ A
Close
êêA F
(
êêF G
)
êêG H
;
êêH I
}
ëë 
}
ìì 	
public
òò 
string
òò 
Existe
òò 
(
òò 
string
òò #
Valor
òò$ )
)
òò) *
{
ôô 	
string
öö 
Rpta
öö 
=
öö 
$str
öö 
;
öö 
SqlConnection
õõ 
sqlCnx
õõ  
=
õõ! "
new
õõ# &
SqlConnection
õõ' 4
(
õõ4 5
)
õõ5 6
;
õõ6 7
try
ùù 
{
ûû 
sqlCnx
†† 
=
†† 
Conexion
†† !
.
††! "
getInstance
††" -
(
††- .
)
††. /
.
††/ 0 
EstablecerConexion
††0 B
(
††B C
)
††C D
;
††D E

SqlCommand
¢¢ 
comando
¢¢ "
=
¢¢# $
new
¢¢% (

SqlCommand
¢¢) 3
(
¢¢3 4
$str
¢¢4 K
,
¢¢K L
sqlCnx
¢¢M S
)
¢¢S T
;
¢¢T U
comando
§§ 
.
§§ 
CommandType
§§ #
=
§§$ %
CommandType
§§& 1
.
§§1 2
StoredProcedure
§§2 A
;
§§A B
comando
¶¶ 
.
¶¶ 

Parameters
¶¶ "
.
¶¶" #
Add
¶¶# &
(
¶¶& '
$str
¶¶' 0
,
¶¶0 1
	SqlDbType
¶¶2 ;
.
¶¶; <
VarChar
¶¶< C
)
¶¶C D
.
¶¶D E
Value
¶¶E J
=
¶¶K L
Valor
¶¶M R
;
¶¶R S
SqlParameter
ßß 
PExiste
ßß $
=
ßß% &
new
ßß' *
SqlParameter
ßß+ 7
(
ßß7 8
)
ßß8 9
;
ßß9 :
PExiste
®® 
.
®® 
ParameterName
®® %
=
®®& '
$str
®®( 2
;
®®2 3
PExiste
©© 
.
©© 
	SqlDbType
©© !
=
©©" #
	SqlDbType
©©$ -
.
©©- .
Int
©©. 1
;
©©1 2
PExiste
™™ 
.
™™ 
	Direction
™™ !
=
™™" # 
ParameterDirection
™™$ 6
.
™™6 7
Output
™™7 =
;
™™= >
comando
¨¨ 
.
¨¨ 

Parameters
¨¨ "
.
¨¨" #
Add
¨¨# &
(
¨¨& '
PExiste
¨¨' .
)
¨¨. /
;
¨¨/ 0
sqlCnx
≠≠ 
.
≠≠ 
Open
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
Rpta
ØØ 
=
ØØ 
Convert
ØØ 
.
ØØ 
ToString
ØØ '
(
ØØ' (
PExiste
ØØ( /
.
ØØ/ 0
Value
ØØ0 5
)
ØØ5 6
;
ØØ6 7
}
±± 
catch
≤≤ 
(
≤≤ 
	Exception
≤≤ 
ex
≤≤ 
)
≤≤  
{
≥≥ 
Rpta
¥¥ 
=
¥¥ 
ex
¥¥ 
.
¥¥ 
Message
¥¥ !
;
¥¥! "
}
µµ 
finally
∂∂ 
{
∑∑ 
if
∏∏ 
(
∏∏ 
sqlCnx
∏∏ 
.
∏∏ 
State
∏∏  
==
∏∏! #
ConnectionState
∏∏$ 3
.
∏∏3 4
Open
∏∏4 8
)
∏∏8 9
sqlCnx
∏∏: @
.
∏∏@ A
Close
∏∏A F
(
∏∏F G
)
∏∏G H
;
∏∏H I
}
ππ 
return
ªª 
Rpta
ªª 
;
ªª 
}
ºº 	
public
øø 
string
øø 
Insertar
øø 
(
øø 
UsuarioEntidad
øø -

objUsuario
øø. 8
)
øø8 9
{
¿¿ 	
string
¡¡ 
Rpta
¡¡ 
=
¡¡ 
$str
¡¡ 
;
¡¡ 
SqlConnection
¬¬ 
sqlCnx
¬¬  
=
¬¬! "
new
¬¬# &
SqlConnection
¬¬' 4
(
¬¬4 5
)
¬¬5 6
;
¬¬6 7
try
ƒƒ 
{
≈≈ 
sqlCnx
«« 
=
«« 
Conexion
«« !
.
««! "
getInstance
««" -
(
««- .
)
««. /
.
««/ 0 
EstablecerConexion
««0 B
(
««B C
)
««C D
;
««D E

SqlCommand
…… 
comando
…… "
=
……# $
new
……% (

SqlCommand
……) 3
(
……3 4
$str
……4 C
,
……C D
sqlCnx
……E K
)
……K L
;
……L M
comando
ÀÀ 
.
ÀÀ 
CommandType
ÀÀ #
=
ÀÀ$ %
CommandType
ÀÀ& 1
.
ÀÀ1 2
StoredProcedure
ÀÀ2 A
;
ÀÀA B
comando
ÕÕ 
.
ÕÕ 

Parameters
ÕÕ "
.
ÕÕ" #
Add
ÕÕ# &
(
ÕÕ& '
$str
ÕÕ' .
,
ÕÕ. /
	SqlDbType
ÕÕ0 9
.
ÕÕ9 :
VarChar
ÕÕ: A
)
ÕÕA B
.
ÕÕB C
Value
ÕÕC H
=
ÕÕI J

objUsuario
ÕÕK U
.
ÕÕU V
Dni
ÕÕV Y
;
ÕÕY Z
comando
ŒŒ 
.
ŒŒ 

Parameters
ŒŒ "
.
ŒŒ" #
Add
ŒŒ# &
(
ŒŒ& '
$str
ŒŒ' 2
,
ŒŒ2 3
	SqlDbType
ŒŒ4 =
.
ŒŒ= >
VarChar
ŒŒ> E
)
ŒŒE F
.
ŒŒF G
Value
ŒŒG L
=
ŒŒM N

objUsuario
ŒŒO Y
.
ŒŒY Z

NomUsuario
ŒŒZ d
;
ŒŒd e
comando
œœ 
.
œœ 

Parameters
œœ "
.
œœ" #
Add
œœ# &
(
œœ& '
$str
œœ' 0
,
œœ0 1
	SqlDbType
œœ2 ;
.
œœ; <
VarChar
œœ< C
)
œœC D
.
œœD E
Value
œœE J
=
œœK L

objUsuario
œœM W
.
œœW X
Clave
œœX ]
;
œœ] ^
comando
–– 
.
–– 

Parameters
–– "
.
––" #
Add
––# &
(
––& '
$str
––' 1
,
––1 2
	SqlDbType
––3 <
.
––< =
Char
––= A
)
––A B
.
––B C
Value
––C H
=
––I J

objUsuario
––K U
.
––U V
Estado
––V \
;
––\ ]
sqlCnx
““ 
.
““ 
Open
““ 
(
““ 
)
““ 
;
““ 
Rpta
‘‘ 
=
‘‘ 
comando
‘‘ 
.
‘‘ 
ExecuteNonQuery
‘‘ .
(
‘‘. /
)
‘‘/ 0
==
‘‘1 3
$num
‘‘4 5
?
‘‘6 7
$str
‘‘8 B
:
‘‘C D
$str
‘‘E e
;
‘‘e f
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
ŸŸ 
Rpta
⁄⁄ 
=
⁄⁄ 
ex
⁄⁄ 
.
⁄⁄ 
Message
⁄⁄ !
;
⁄⁄! "
}
€€ 
finally
‹‹ 
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
sqlCnx
ﬁﬁ 
.
ﬁﬁ 
State
ﬁﬁ  
==
ﬁﬁ! #
ConnectionState
ﬁﬁ$ 3
.
ﬁﬁ3 4
Open
ﬁﬁ4 8
)
ﬁﬁ8 9
sqlCnx
ﬁﬁ: @
.
ﬁﬁ@ A
Close
ﬁﬁA F
(
ﬁﬁF G
)
ﬁﬁG H
;
ﬁﬁH I
}
ﬂﬂ 
return
·· 
Rpta
·· 
;
·· 
}
‚‚ 	
public
ÁÁ 
string
ÁÁ 

Actualizar
ÁÁ  
(
ÁÁ  !
UsuarioEntidad
ÁÁ! /

objUsuario
ÁÁ0 :
)
ÁÁ: ;
{
ËË 	
string
ÈÈ 
Rpta
ÈÈ 
=
ÈÈ 
$str
ÈÈ 
;
ÈÈ 
SqlConnection
ÍÍ 
sqlCnx
ÍÍ  
=
ÍÍ! "
new
ÍÍ# &
SqlConnection
ÍÍ' 4
(
ÍÍ4 5
)
ÍÍ5 6
;
ÍÍ6 7
try
ÏÏ 
{
ÌÌ 
sqlCnx
ÔÔ 
=
ÔÔ 
Conexion
ÔÔ !
.
ÔÔ! "
getInstance
ÔÔ" -
(
ÔÔ- .
)
ÔÔ. /
.
ÔÔ/ 0 
EstablecerConexion
ÔÔ0 B
(
ÔÔB C
)
ÔÔC D
;
ÔÔD E

SqlCommand
ÒÒ 
comando
ÒÒ "
=
ÒÒ# $
new
ÒÒ% (

SqlCommand
ÒÒ) 3
(
ÒÒ3 4
$str
ÒÒ4 C
,
ÒÒC D
sqlCnx
ÒÒE K
)
ÒÒK L
;
ÒÒL M
comando
ÛÛ 
.
ÛÛ 
CommandType
ÛÛ #
=
ÛÛ$ %
CommandType
ÛÛ& 1
.
ÛÛ1 2
StoredProcedure
ÛÛ2 A
;
ÛÛA B
comando
ıı 
.
ıı 

Parameters
ıı "
.
ıı" #
Add
ıı# &
(
ıı& '
$str
ıı' 5
,
ıı5 6
	SqlDbType
ıı7 @
.
ıı@ A
Int
ııA D
)
ııD E
.
ııE F
Value
ııF K
=
ııL M

objUsuario
ııN X
.
ııX Y
	UsuarioId
ııY b
;
ııb c
comando
ˆˆ 
.
ˆˆ 

Parameters
ˆˆ "
.
ˆˆ" #
Add
ˆˆ# &
(
ˆˆ& '
$str
ˆˆ' .
,
ˆˆ. /
	SqlDbType
ˆˆ0 9
.
ˆˆ9 :
Char
ˆˆ: >
)
ˆˆ> ?
.
ˆˆ? @
Value
ˆˆ@ E
=
ˆˆF G

objUsuario
ˆˆH R
.
ˆˆR S
Dni
ˆˆS V
;
ˆˆV W
comando
˜˜ 
.
˜˜ 

Parameters
˜˜ "
.
˜˜" #
Add
˜˜# &
(
˜˜& '
$str
˜˜' 2
,
˜˜2 3
	SqlDbType
˜˜4 =
.
˜˜= >
VarChar
˜˜> E
)
˜˜E F
.
˜˜F G
Value
˜˜G L
=
˜˜M N

objUsuario
˜˜O Y
.
˜˜Y Z

NomUsuario
˜˜Z d
;
˜˜d e
comando
¯¯ 
.
¯¯ 

Parameters
¯¯ "
.
¯¯" #
Add
¯¯# &
(
¯¯& '
$str
¯¯' 0
,
¯¯0 1
	SqlDbType
¯¯2 ;
.
¯¯; <
VarChar
¯¯< C
)
¯¯C D
.
¯¯D E
Value
¯¯E J
=
¯¯K L

objUsuario
¯¯M W
.
¯¯W X
Clave
¯¯X ]
;
¯¯] ^
comando
˘˘ 
.
˘˘ 

Parameters
˘˘ "
.
˘˘" #
Add
˘˘# &
(
˘˘& '
$str
˘˘' 1
,
˘˘1 2
	SqlDbType
˘˘3 <
.
˘˘< =
Char
˘˘= A
)
˘˘A B
.
˘˘B C
Value
˘˘C H
=
˘˘I J

objUsuario
˘˘K U
.
˘˘U V
Estado
˘˘V \
;
˘˘\ ]
sqlCnx
˚˚ 
.
˚˚ 
Open
˚˚ 
(
˚˚ 
)
˚˚ 
;
˚˚ 
Rpta
˝˝ 
=
˝˝ 
comando
˝˝ 
.
˝˝ 
ExecuteNonQuery
˝˝ .
(
˝˝. /
)
˝˝/ 0
==
˝˝1 3
$num
˝˝4 5
?
˝˝6 7
$str
˝˝8 B
:
˝˝C D
$str
˝˝E g
;
˝˝g h
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÇÇ 
Rpta
ÉÉ 
=
ÉÉ 
ex
ÉÉ 
.
ÉÉ 
Message
ÉÉ !
;
ÉÉ! "
}
ÑÑ 
finally
ÖÖ 
{
ÜÜ 
if
áá 
(
áá 
sqlCnx
áá 
.
áá 
State
áá  
==
áá! #
ConnectionState
áá$ 3
.
áá3 4
Open
áá4 8
)
áá8 9
sqlCnx
áá: @
.
áá@ A
Close
ááA F
(
ááF G
)
ááG H
;
ááH I
}
àà 
return
ää 
Rpta
ää 
;
ää 
}
ãã 	
public
èè 
string
èè 
Eliminar
èè 
(
èè 
int
èè "
Id
èè# %
)
èè% &
{
êê 	
string
ëë 
Rpta
ëë 
=
ëë 
$str
ëë 
;
ëë 
SqlConnection
íí 
sqlCnx
íí  
=
íí! "
new
íí# &
SqlConnection
íí' 4
(
íí4 5
)
íí5 6
;
íí6 7
try
îî 
{
ïï 
sqlCnx
óó 
=
óó 
Conexion
óó !
.
óó! "
getInstance
óó" -
(
óó- .
)
óó. /
.
óó/ 0 
EstablecerConexion
óó0 B
(
óóB C
)
óóC D
;
óóD E

SqlCommand
ôô 
comando
ôô "
=
ôô# $
new
ôô% (

SqlCommand
ôô) 3
(
ôô3 4
$str
ôô4 C
,
ôôC D
sqlCnx
ôôE K
)
ôôK L
;
ôôL M
comando
õõ 
.
õõ 
CommandType
õõ #
=
õõ$ %
CommandType
õõ& 1
.
õõ1 2
StoredProcedure
õõ2 A
;
õõA B
comando
ùù 
.
ùù 

Parameters
ùù "
.
ùù" #
Add
ùù# &
(
ùù& '
$str
ùù' 5
,
ùù5 6
	SqlDbType
ùù7 @
.
ùù@ A
Int
ùùA D
)
ùùD E
.
ùùE F
Value
ùùF K
=
ùùL M
Id
ùùN P
;
ùùP Q
sqlCnx
üü 
.
üü 
Open
üü 
(
üü 
)
üü 
;
üü 
Rpta
°° 
=
°° 
comando
°° 
.
°° 
ExecuteNonQuery
°° .
(
°°. /
)
°°/ 0
==
°°1 3
$num
°°4 5
?
°°6 7
$str
°°8 B
:
°°C D
$str
°°E e
;
°°e f
}
§§ 
catch
•• 
(
•• 
	Exception
•• 
ex
•• 
)
••  
{
¶¶ 
Rpta
ßß 
=
ßß 
ex
ßß 
.
ßß 
Message
ßß !
;
ßß! "
}
®® 
finally
©© 
{
™™ 
if
´´ 
(
´´ 
sqlCnx
´´ 
.
´´ 
State
´´  
==
´´! #
ConnectionState
´´$ 3
.
´´3 4
Open
´´4 8
)
´´8 9
sqlCnx
´´: @
.
´´@ A
Close
´´A F
(
´´F G
)
´´G H
;
´´H I
}
¨¨ 
return
ÆÆ 
Rpta
ÆÆ 
;
ÆÆ 
}
ØØ 	
public
∂∂ 
string
∂∂ 
Activar
∂∂ 
(
∂∂ 
int
∂∂ !
Id
∂∂" $
)
∂∂$ %
{
∑∑ 	
string
∏∏ 
Rpta
∏∏ 
=
∏∏ 
$str
∏∏ 
;
∏∏ 
SqlConnection
ππ 
sqlCnx
ππ  
=
ππ! "
new
ππ# &
SqlConnection
ππ' 4
(
ππ4 5
)
ππ5 6
;
ππ6 7
try
ªª 
{
ºº 
sqlCnx
ææ 
=
ææ 
Conexion
ææ !
.
ææ! "
getInstance
ææ" -
(
ææ- .
)
ææ. /
.
ææ/ 0 
EstablecerConexion
ææ0 B
(
ææB C
)
ææC D
;
ææD E

SqlCommand
¿¿ 
comando
¿¿ "
=
¿¿# $
new
¿¿% (

SqlCommand
¿¿) 3
(
¿¿3 4
$str
¿¿4 I
,
¿¿I J
sqlCnx
¿¿K Q
)
¿¿Q R
;
¿¿R S
comando
¬¬ 
.
¬¬ 
CommandType
¬¬ #
=
¬¬$ %
CommandType
¬¬& 1
.
¬¬1 2
StoredProcedure
¬¬2 A
;
¬¬A B
comando
ƒƒ 
.
ƒƒ 

Parameters
ƒƒ "
.
ƒƒ" #
Add
ƒƒ# &
(
ƒƒ& '
$str
ƒƒ' 5
,
ƒƒ5 6
	SqlDbType
ƒƒ7 @
.
ƒƒ@ A
Int
ƒƒA D
)
ƒƒD E
.
ƒƒE F
Value
ƒƒF K
=
ƒƒL M
Id
ƒƒN P
;
ƒƒP Q
sqlCnx
∆∆ 
.
∆∆ 
Open
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
Rpta
»» 
=
»» 
comando
»» 
.
»» 
ExecuteNonQuery
»» .
(
»». /
)
»»/ 0
==
»»1 3
$num
»»4 5
?
»»6 7
$str
»»8 B
:
»»C D
$str
»»E d
;
»»d e
}
ÀÀ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÕÕ 
Rpta
ŒŒ 
=
ŒŒ 
ex
ŒŒ 
.
ŒŒ 
Message
ŒŒ !
;
ŒŒ! "
}
œœ 
finally
–– 
{
—— 
if
““ 
(
““ 
sqlCnx
““ 
.
““ 
State
““  
==
““! #
ConnectionState
““$ 3
.
““3 4
Open
““4 8
)
““8 9
sqlCnx
““: @
.
““@ A
Close
““A F
(
““F G
)
““G H
;
““H I
}
”” 
return
’’ 
Rpta
’’ 
;
’’ 
}
÷÷ 	
public
⁄⁄ 
string
⁄⁄ 

Desactivar
⁄⁄  
(
⁄⁄  !
int
⁄⁄! $
Id
⁄⁄% '
)
⁄⁄' (
{
€€ 	
string
‹‹ 
Rpta
‹‹ 
=
‹‹ 
$str
‹‹ 
;
‹‹ 
SqlConnection
›› 
sqlCnx
››  
=
››! "
new
››# &
SqlConnection
››' 4
(
››4 5
)
››5 6
;
››6 7
try
ﬂﬂ 
{
‡‡ 
sqlCnx
‚‚ 
=
‚‚ 
Conexion
‚‚ !
.
‚‚! "
getInstance
‚‚" -
(
‚‚- .
)
‚‚. /
.
‚‚/ 0 
EstablecerConexion
‚‚0 B
(
‚‚B C
)
‚‚C D
;
‚‚D E

SqlCommand
‰‰ 
comando
‰‰ "
=
‰‰# $
new
‰‰% (

SqlCommand
‰‰) 3
(
‰‰3 4
$str
‰‰4 L
,
‰‰L M
sqlCnx
‰‰N T
)
‰‰T U
;
‰‰U V
comando
ÊÊ 
.
ÊÊ 
CommandType
ÊÊ #
=
ÊÊ$ %
CommandType
ÊÊ& 1
.
ÊÊ1 2
StoredProcedure
ÊÊ2 A
;
ÊÊA B
comando
ËË 
.
ËË 

Parameters
ËË "
.
ËË" #
Add
ËË# &
(
ËË& '
$str
ËË' 5
,
ËË5 6
	SqlDbType
ËË7 @
.
ËË@ A
Int
ËËA D
)
ËËD E
.
ËËE F
Value
ËËF K
=
ËËL M
Id
ËËN P
;
ËËP Q
sqlCnx
ÍÍ 
.
ÍÍ 
Open
ÍÍ 
(
ÍÍ 
)
ÍÍ 
;
ÍÍ 
Rpta
ÏÏ 
=
ÏÏ 
comando
ÏÏ 
.
ÏÏ 
ExecuteNonQuery
ÏÏ .
(
ÏÏ. /
)
ÏÏ/ 0
==
ÏÏ1 3
$num
ÏÏ4 5
?
ÏÏ6 7
$str
ÏÏ8 B
:
ÏÏC D
$str
ÏÏE g
;
ÏÏg h
}
ÔÔ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ÒÒ 
Rpta
ÚÚ 
=
ÚÚ 
ex
ÚÚ 
.
ÚÚ 
Message
ÚÚ !
;
ÚÚ! "
}
ÛÛ 
finally
ÙÙ 
{
ıı 
if
ˆˆ 
(
ˆˆ 
sqlCnx
ˆˆ 
.
ˆˆ 
State
ˆˆ  
==
ˆˆ! #
ConnectionState
ˆˆ$ 3
.
ˆˆ3 4
Open
ˆˆ4 8
)
ˆˆ8 9
sqlCnx
ˆˆ: @
.
ˆˆ@ A
Close
ˆˆA F
(
ˆˆF G
)
ˆˆG H
;
ˆˆH I
}
˜˜ 
return
˘˘ 
Rpta
˘˘ 
;
˘˘ 
}
˙˙ 	
}
˝˝ 
}˛˛ 